Index: msm/arch/arm/kernel/perf_event.c
===================================================================
--- msm.orig/arch/arm/kernel/perf_event.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/kernel/perf_event.c	2012-09-14 19:06:53.627212814 -0400
@@ -696,7 +696,7 @@
 	return 0;
 }
 
-static struct platform_driver armpmu_driver = {
+static struct platform_driver armpmu_driver  __initdata =  {
 	.driver		= {
 		.name	= "cpu-arm-pmu",
 		.of_match_table = armpmu_of_device_ids,
Index: msm/arch/arm/mach-msm/mdm2.c
===================================================================
--- msm.orig/arch/arm/mach-msm/mdm2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/mdm2.c	2012-09-14 19:06:53.627212814 -0400
@@ -298,7 +298,7 @@
 	mdm_common_modem_shutdown(pdev);
 }
 
-static struct platform_driver mdm_modem_driver = {
+static struct platform_driver mdm_modem_driver  __exitdata =  {
 	.remove         = mdm_modem_remove,
 	.shutdown	= mdm_modem_shutdown,
 	.driver         = {
Index: msm/arch/arm/mach-msm/perf_event_msm_krait_l2.c
===================================================================
--- msm.orig/arch/arm/mach-msm/perf_event_msm_krait_l2.c	2012-09-14 19:06:46.000000000 -0400
+++ msm/arch/arm/mach-msm/perf_event_msm_krait_l2.c	2012-09-14 19:06:53.627212814 -0400
@@ -542,7 +542,7 @@
 	return 0;
 }
 
-static struct platform_driver krait_l2_pmu_driver = {
+static struct platform_driver krait_l2_pmu_driver  __initdata =  {
 	.driver		= {
 		.name	= "l2-arm-pmu",
 	},
Index: msm/arch/arm/mach-msm/pil-gss.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-gss.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-gss.c	2012-09-14 19:06:53.627212814 -0400
@@ -373,7 +373,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_gss_driver = {
+static struct platform_driver pil_gss_driver  __refdata =  {
 	.probe = pil_gss_probe,
 	.remove = __devexit_p(pil_gss_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/pil-q6v4.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-q6v4.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-q6v4.c	2012-09-14 19:06:53.627212814 -0400
@@ -441,7 +441,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_q6v4_driver = {
+static struct platform_driver pil_q6v4_driver  __refdata =  {
 	.probe = pil_q6v4_driver_probe,
 	.remove = __devexit_p(pil_q6v4_driver_exit),
 	.driver = {
Index: msm/arch/arm/mach-msm/pil-riva.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-riva.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-riva.c	2012-09-14 19:06:53.627212814 -0400
@@ -347,7 +347,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_riva_driver = {
+static struct platform_driver pil_riva_driver  __refdata =  {
 	.probe = pil_riva_probe,
 	.remove = __devexit_p(pil_riva_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/pil-vidc.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-vidc.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-vidc.c	2012-09-14 19:06:53.627212814 -0400
@@ -105,7 +105,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_vidc_driver = {
+static struct platform_driver pil_vidc_driver  __refdata =  {
 	.probe = pil_vidc_driver_probe,
 	.remove = __devexit_p(pil_vidc_driver_exit),
 	.driver = {
Index: msm/arch/arm/mach-msm/pm-boot.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pm-boot.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pm-boot.c	2012-09-14 19:11:01.060102076 -0400
@@ -256,7 +256,7 @@
 	{},
 };
 
-static struct platform_driver msm_pm_boot_driver = {
+static struct platform_driver msm_pm_boot_driver  __devinitdata =  {
 	.probe = msm_pm_boot_probe,
 	.driver = {
 		.name = "pm-boot",
Index: msm/arch/arm/mach-msm/spm_devices.c
===================================================================
--- msm.orig/arch/arm/mach-msm/spm_devices.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/spm_devices.c	2012-09-14 19:06:53.627212814 -0400
@@ -379,7 +379,7 @@
 	{},
 };
 
-static struct platform_driver msm_spm_device_driver = {
+static struct platform_driver msm_spm_device_driver  __initdata =  {
 	.probe = msm_spm_dev_probe,
 	.driver = {
 		.name = "spm-v2",
Index: msm/arch/arm/mach-msm/tz_log.c
===================================================================
--- msm.orig/arch/arm/mach-msm/tz_log.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/tz_log.c	2012-09-14 19:06:53.627212814 -0400
@@ -542,7 +542,7 @@
 	{}
 };
 
-static struct platform_driver tz_log_driver = {
+static struct platform_driver tz_log_driver  __refdata =  {
 	.probe		= tz_log_probe,
 	.remove		= __devexit_p(tz_log_remove),
 	.driver		= {
Index: msm/drivers/coresight/coresight-etb.c
===================================================================
--- msm.orig/drivers/coresight/coresight-etb.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/coresight/coresight-etb.c	2012-09-14 19:06:53.631212714 -0400
@@ -441,7 +441,7 @@
 	{}
 };
 
-static struct platform_driver etb_driver = {
+static struct platform_driver etb_driver  __refdata =  {
 	.probe          = etb_probe,
 	.remove         = __devexit_p(etb_remove),
 	.driver         = {
Index: msm/drivers/coresight/coresight-etm.c
===================================================================
--- msm.orig/drivers/coresight/coresight-etm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/coresight/coresight-etm.c	2012-09-14 19:06:53.631212714 -0400
@@ -1631,7 +1631,7 @@
 	{}
 };
 
-static struct platform_driver etm_driver = {
+static struct platform_driver etm_driver  __refdata =  {
 	.probe          = etm_probe,
 	.remove         = __devexit_p(etm_remove),
 	.driver         = {
Index: msm/drivers/coresight/coresight-funnel.c
===================================================================
--- msm.orig/drivers/coresight/coresight-funnel.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/coresight/coresight-funnel.c	2012-09-14 19:06:53.631212714 -0400
@@ -234,7 +234,7 @@
 	{}
 };
 
-static struct platform_driver funnel_driver = {
+static struct platform_driver funnel_driver  __refdata =  {
 	.probe          = funnel_probe,
 	.remove         = __devexit_p(funnel_remove),
 	.driver         = {
Index: msm/drivers/coresight/coresight-stm.c
===================================================================
--- msm.orig/drivers/coresight/coresight-stm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/coresight/coresight-stm.c	2012-09-14 19:06:53.631212714 -0400
@@ -747,7 +747,7 @@
 	{}
 };
 
-static struct platform_driver stm_driver = {
+static struct platform_driver stm_driver  __refdata =  {
 	.probe          = stm_probe,
 	.remove         = __devexit_p(stm_remove),
 	.driver         = {
Index: msm/drivers/coresight/coresight-tpiu.c
===================================================================
--- msm.orig/drivers/coresight/coresight-tpiu.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/coresight/coresight-tpiu.c	2012-09-14 19:06:53.631212714 -0400
@@ -206,7 +206,7 @@
 	{}
 };
 
-static struct platform_driver tpiu_driver = {
+static struct platform_driver tpiu_driver  __refdata =  {
 	.probe          = tpiu_probe,
 	.remove         = __devexit_p(tpiu_remove),
 	.driver         = {
Index: msm/drivers/hwmon/epm_adc.c
===================================================================
--- msm.orig/drivers/hwmon/epm_adc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/hwmon/epm_adc.c	2012-09-14 19:06:53.631212714 -0400
@@ -1824,7 +1824,7 @@
 	return 0;
 }
 
-static struct platform_driver epm_adc_driver = {
+static struct platform_driver epm_adc_driver  __refdata =  {
 	.probe = epm_adc_probe,
 	.remove = __devexit_p(epm_adc_remove),
 	.driver = {
Index: msm/drivers/hwmon/pm8xxx-adc.c
===================================================================
--- msm.orig/drivers/hwmon/pm8xxx-adc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/hwmon/pm8xxx-adc.c	2012-09-14 19:10:38.980379330 -0400
@@ -1274,7 +1274,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_adc_driver = {
+static struct platform_driver pm8xxx_adc_driver  __refdata =  {
 	.probe	= pm8xxx_adc_probe,
 	.remove	= __devexit_p(pm8xxx_adc_teardown),
 	.driver	= {
Index: msm/drivers/leds/leds-pm8xxx.c
===================================================================
--- msm.orig/drivers/leds/leds-pm8xxx.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/leds/leds-pm8xxx.c	2012-09-14 19:06:53.631212714 -0400
@@ -982,7 +982,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_led_driver = {
+static struct platform_driver pm8xxx_led_driver  __refdata =  {
 	.probe		= pm8xxx_led_probe,
 	.remove		= __devexit_p(pm8xxx_led_remove),
 	.driver		= {
Index: msm/drivers/media/radio/radio-iris.c
===================================================================
--- msm.orig/drivers/media/radio/radio-iris.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/radio/radio-iris.c	2012-09-14 19:06:53.631212714 -0400
@@ -3669,7 +3669,7 @@
 	return 0;
 }
 
-static struct platform_driver iris_driver = {
+static struct platform_driver iris_driver  __exitdata =  {
 	.driver = {
 		.owner  = THIS_MODULE,
 		.name   = "iris_fm",
Index: msm/drivers/media/video/msm/csi/msm_csid.c
===================================================================
--- msm.orig/drivers/media/video/msm/csi/msm_csid.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/video/msm/csi/msm_csid.c	2012-09-14 19:06:53.631212714 -0400
@@ -624,7 +624,7 @@
 
 MODULE_DEVICE_TABLE(of, msm_csid_dt_match);
 
-static struct platform_driver csid_driver = {
+static struct platform_driver csid_driver  __initdata =  {
 	.probe = csid_probe,
 	.driver = {
 		.name = MSM_CSID_DRV_NAME,
Index: msm/drivers/media/video/msm/csi/msm_csiphy.c
===================================================================
--- msm.orig/drivers/media/video/msm/csi/msm_csiphy.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/video/msm/csi/msm_csiphy.c	2012-09-14 19:06:53.631212714 -0400
@@ -440,7 +440,7 @@
 
 MODULE_DEVICE_TABLE(of, msm_csiphy_dt_match);
 
-static struct platform_driver csiphy_driver = {
+static struct platform_driver csiphy_driver  __initdata =  {
 	.probe = csiphy_probe,
 	.driver = {
 		.name = MSM_CSIPHY_DRV_NAME,
Index: msm/drivers/media/video/msm/csi/msm_ispif.c
===================================================================
--- msm.orig/drivers/media/video/msm/csi/msm_ispif.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/video/msm/csi/msm_ispif.c	2012-09-14 19:06:53.635212642 -0400
@@ -903,7 +903,7 @@
 
 MODULE_DEVICE_TABLE(of, msm_ispif_dt_match);
 
-static struct platform_driver ispif_driver = {
+static struct platform_driver ispif_driver  __initdata =  {
 	.probe = ispif_probe,
 	.driver = {
 		.name = MSM_ISPIF_DRV_NAME,
Index: msm/drivers/media/video/msm/io/msm_camera_i2c_mux.c
===================================================================
--- msm.orig/drivers/media/video/msm/io/msm_camera_i2c_mux.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/video/msm/io/msm_camera_i2c_mux.c	2012-09-14 19:06:53.635212642 -0400
@@ -163,7 +163,7 @@
 	return 0;
 }
 
-static struct platform_driver i2c_mux_driver = {
+static struct platform_driver i2c_mux_driver  __initdata =  {
 	.probe = i2c_mux_probe,
 	.driver = {
 		.name = MSM_I2C_MUX_DRV_NAME,
Index: msm/drivers/mfd/pm8038-core.c
===================================================================
--- msm.orig/drivers/mfd/pm8038-core.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8038-core.c	2012-09-14 19:06:53.635212642 -0400
@@ -806,7 +806,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8038_driver = {
+static struct platform_driver pm8038_driver  __refdata =  {
 	.probe		= pm8038_probe,
 	.remove		= __devexit_p(pm8038_remove),
 	.driver		= {
Index: msm/drivers/mfd/pm8821-core.c
===================================================================
--- msm.orig/drivers/mfd/pm8821-core.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8821-core.c	2012-09-14 19:06:53.635212642 -0400
@@ -324,7 +324,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8821_driver = {
+static struct platform_driver pm8821_driver  __refdata =  {
 	.probe		= pm8821_probe,
 	.remove		= __devexit_p(pm8821_remove),
 	.driver		= {
Index: msm/drivers/mfd/pm8921-core.c
===================================================================
--- msm.orig/drivers/mfd/pm8921-core.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8921-core.c	2012-09-14 19:06:53.635212642 -0400
@@ -972,7 +972,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8921_driver = {
+static struct platform_driver pm8921_driver  __refdata =  {
 	.probe		= pm8921_probe,
 	.remove		= __devexit_p(pm8921_remove),
 	.driver		= {
Index: msm/drivers/mfd/pm8xxx-pwm.c
===================================================================
--- msm.orig/drivers/mfd/pm8xxx-pwm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8xxx-pwm.c	2012-09-14 19:06:53.635212642 -0400
@@ -1443,7 +1443,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_pwm_driver = {
+static struct platform_driver pm8xxx_pwm_driver  __refdata =  {
 	.probe		= pm8xxx_pwm_probe,
 	.remove		= __devexit_p(pm8xxx_pwm_remove),
 	.driver		= {
Index: msm/drivers/misc/qseecom.c
===================================================================
--- msm.orig/drivers/misc/qseecom.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/misc/qseecom.c	2012-09-14 19:06:53.635212642 -0400
@@ -1817,7 +1817,7 @@
 	{}
 };
 
-static struct platform_driver qseecom_plat_driver = {
+static struct platform_driver qseecom_plat_driver  __refdata =  {
 	.probe = qseecom_probe,
 	.remove = qseecom_remove,
 	.driver = {
Index: msm/drivers/platform/msm/sps/sps.c
===================================================================
--- msm.orig/drivers/platform/msm/sps/sps.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/platform/msm/sps/sps.c	2012-09-14 19:06:53.635212642 -0400
@@ -2323,7 +2323,7 @@
 	{}
 };
 
-static struct platform_driver msm_sps_driver = {
+static struct platform_driver msm_sps_driver  __initdata =  {
 	.probe          = msm_sps_probe,
 	.driver		= {
 		.name	= SPS_DRV_NAME,
Index: msm/drivers/power/pm8921-bms.c
===================================================================
--- msm.orig/drivers/power/pm8921-bms.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/pm8921-bms.c	2012-09-14 19:06:53.635212642 -0400
@@ -3282,7 +3282,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8921_bms_driver = {
+static struct platform_driver pm8921_bms_driver  __refdata =  {
 	.probe	= pm8921_bms_probe,
 	.remove	= __devexit_p(pm8921_bms_remove),
 	.driver	= {
Index: msm/drivers/power/pm8921-charger.c
===================================================================
--- msm.orig/drivers/power/pm8921-charger.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/pm8921-charger.c	2012-09-14 19:06:53.635212642 -0400
@@ -4172,7 +4172,7 @@
 	.resume_noirq   = pm8921_charger_resume_noirq,
 	.resume		= pm8921_charger_resume,
 };
-static struct platform_driver pm8921_charger_driver = {
+static struct platform_driver pm8921_charger_driver  __refdata =  {
 	.probe		= pm8921_charger_probe,
 	.remove		= __devexit_p(pm8921_charger_remove),
 	.driver		= {
Index: msm/drivers/power/pm8xxx-ccadc.c
===================================================================
--- msm.orig/drivers/power/pm8xxx-ccadc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/pm8xxx-ccadc.c	2012-09-14 19:06:53.639212584 -0400
@@ -712,7 +712,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_ccadc_driver = {
+static struct platform_driver pm8xxx_ccadc_driver  __refdata =  {
 	.probe	= pm8xxx_ccadc_probe,
 	.remove	= __devexit_p(pm8xxx_ccadc_remove),
 	.driver	= {
Index: msm/drivers/regulator/msm-gpio-regulator.c
===================================================================
--- msm.orig/drivers/regulator/msm-gpio-regulator.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/regulator/msm-gpio-regulator.c	2012-09-14 19:06:53.639212584 -0400
@@ -196,7 +196,7 @@
 	return 0;
 }
 
-static struct platform_driver gpio_vreg_driver = {
+static struct platform_driver gpio_vreg_driver  __refdata =  {
 	.probe = gpio_vreg_probe,
 	.remove = __devexit_p(gpio_vreg_remove),
 	.driver = {
Index: msm/drivers/regulator/pm8xxx-regulator.c
===================================================================
--- msm.orig/drivers/regulator/pm8xxx-regulator.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/regulator/pm8xxx-regulator.c	2012-09-14 19:06:53.639212584 -0400
@@ -3318,7 +3318,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_vreg_driver = {
+static struct platform_driver pm8xxx_vreg_driver  __refdata =  {
 	.probe	= pm8xxx_vreg_probe,
 	.remove	= __devexit_p(pm8xxx_vreg_remove),
 	.driver	= {
Index: msm/drivers/slimbus/slim-msm-ctrl.c
===================================================================
--- msm.orig/drivers/slimbus/slim-msm-ctrl.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/slimbus/slim-msm-ctrl.c	2012-09-14 19:06:53.639212584 -0400
@@ -2362,7 +2362,7 @@
 	{}
 };
 
-static struct platform_driver msm_slim_driver = {
+static struct platform_driver msm_slim_driver  __refdata =  {
 	.probe = msm_slim_probe,
 	.remove = msm_slim_remove,
 	.driver	= {
Index: msm/drivers/staging/android/ram_console.c
===================================================================
--- msm.orig/drivers/staging/android/ram_console.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/staging/android/ram_console.c	2012-09-14 19:06:53.639212584 -0400
@@ -74,7 +74,7 @@
 	return 0;
 }
 
-static struct platform_driver ram_console_driver = {
+static struct platform_driver ram_console_driver  __initdata =  {
 	.driver		= {
 		.name	= "ram_console",
 	},
Index: msm/drivers/staging/tidspbridge/rmgr/drv_interface.c
===================================================================
--- msm.orig/drivers/staging/tidspbridge/rmgr/drv_interface.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/staging/tidspbridge/rmgr/drv_interface.c	2012-09-14 19:06:53.639212584 -0400
@@ -601,7 +601,7 @@
 }
 #endif
 
-static struct platform_driver bridge_driver = {
+static struct platform_driver bridge_driver  __initdata =  {
 	.driver = {
 		   .name = "omap-dsp",
 		   },
Index: msm/drivers/thermal/msm8960_tsens.c
===================================================================
--- msm.orig/drivers/thermal/msm8960_tsens.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/thermal/msm8960_tsens.c	2012-09-14 19:06:53.639212584 -0400
@@ -1041,7 +1041,7 @@
 	return 0;
 }
 
-static struct platform_driver tsens_tm_driver = {
+static struct platform_driver tsens_tm_driver  __refdata =  {
 	.probe = tsens_tm_probe,
 	.remove = tsens_tm_remove,
 	.driver = {
Index: msm/drivers/thermal/msm8974-tsens.c
===================================================================
--- msm.orig/drivers/thermal/msm8974-tsens.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/thermal/msm8974-tsens.c	2012-09-14 19:06:53.639212584 -0400
@@ -941,7 +941,7 @@
 	{}
 };
 
-static struct platform_driver tsens_tm_driver = {
+static struct platform_driver tsens_tm_driver  __refdata =  {
 	.probe = tsens_tm_probe,
 	.remove = tsens_tm_remove,
 	.driver = {
Index: msm/drivers/thermal/msm_tsens.c
===================================================================
--- msm.orig/drivers/thermal/msm_tsens.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/thermal/msm_tsens.c	2012-09-14 19:06:53.639212584 -0400
@@ -634,7 +634,7 @@
 	return 0;
 }
 
-static struct platform_driver tsens_tm_driver = {
+static struct platform_driver tsens_tm_driver  __refdata =  {
 	.probe	= tsens_tm_probe,
 	.remove	= __devexit_p(tsens_tm_remove),
 	.driver	= {
Index: msm/drivers/usb/gadget/android.c
===================================================================
--- msm.orig/drivers/usb/gadget/android.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/gadget/android.c	2012-09-14 19:06:53.639212584 -0400
@@ -2355,7 +2355,7 @@
 	},
 };
 
-static struct platform_driver android_platform_driver = {
+static struct platform_driver android_platform_driver  __initdata =  {
 	.driver = { .name = "android_usb"},
 	.probe = android_probe,
 	.remove = android_remove,
Index: msm/drivers/usb/host/ehci-msm-hsic.c
===================================================================
--- msm.orig/drivers/usb/host/ehci-msm-hsic.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/host/ehci-msm-hsic.c	2012-09-14 19:06:53.639212584 -0400
@@ -1842,7 +1842,7 @@
 };
 #endif
 
-static struct platform_driver ehci_msm_hsic_driver = {
+static struct platform_driver ehci_msm_hsic_driver  __refdata =  {
 	.probe	= ehci_hsic_msm_probe,
 	.remove	= __devexit_p(ehci_hsic_msm_remove),
 	.driver = {
Index: msm/drivers/video/msm/lvds_chimei_wxga.c
===================================================================
--- msm.orig/drivers/video/msm/lvds_chimei_wxga.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lvds_chimei_wxga.c	2012-09-14 19:06:53.639212584 -0400
@@ -92,7 +92,7 @@
 	return rc;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver  __initdata =  {
 	.probe  = lvds_chimei_probe,
 	.driver = {
 		.name   = "lvds_chimei_wxga",
Index: msm/drivers/video/msm/lvds_frc_fhd.c
===================================================================
--- msm.orig/drivers/video/msm/lvds_frc_fhd.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lvds_frc_fhd.c	2012-09-14 19:06:53.639212584 -0400
@@ -126,7 +126,7 @@
 	return rc;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver  __initdata =  {
 	.probe  = lvds_frc_probe,
 	.driver = {
 		.name   = "lvds_frc_fhd",
Index: msm/drivers/video/msm/mipi_orise.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_orise.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_orise.c	2012-09-14 19:06:53.639212584 -0400
@@ -130,7 +130,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver  __initdata =  {
 	.probe  = mipi_orise_lcd_probe,
 	.driver = {
 		.name   = "mipi_orise",
Index: msm/drivers/video/vfb.c
===================================================================
--- msm.orig/drivers/video/vfb.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/vfb.c	2012-09-14 19:06:53.639212584 -0400
@@ -566,7 +566,7 @@
 	return 0;
 }
 
-static struct platform_driver vfb_driver = {
+static struct platform_driver vfb_driver  __initdata =  {
 	.probe	= vfb_probe,
 	.remove = vfb_remove,
 	.driver = {
Index: msm/sound/soc/codecs/msm_stub.c
===================================================================
--- msm.orig/sound/soc/codecs/msm_stub.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/codecs/msm_stub.c	2012-09-14 19:06:53.639212584 -0400
@@ -64,7 +64,7 @@
 	{}
 };
 
-static struct platform_driver msm_stub_driver = {
+static struct platform_driver msm_stub_driver  __refdata =  {
 	.driver = {
 		.name = "msm-stub-codec",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/codecs/wcd9304.c
===================================================================
--- msm.orig/sound/soc/codecs/wcd9304.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/codecs/wcd9304.c	2012-09-14 19:06:53.643212530 -0400
@@ -5366,7 +5366,7 @@
 #endif
 	return 0;
 }
-static struct platform_driver sitar_codec_driver = {
+static struct platform_driver sitar_codec_driver  __refdata =  {
 	.probe = sitar_probe,
 	.remove = sitar_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-compr-q6.c
===================================================================
--- msm.orig/sound/soc/msm/msm-compr-q6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-compr-q6.c	2012-09-14 19:06:53.643212530 -0400
@@ -1154,7 +1154,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_compr_driver = {
+static struct platform_driver msm_compr_driver  __initdata =  {
 	.driver = {
 		.name = "msm-compr-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-dai-fe.c
===================================================================
--- msm.orig/sound/soc/msm/msm-dai-fe.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-dai-fe.c	2012-09-14 19:06:53.643212530 -0400
@@ -501,7 +501,7 @@
 	{}
 };
 
-static struct platform_driver msm_fe_dai_driver = {
+static struct platform_driver msm_fe_dai_driver  __refdata =  {
 	.probe  = msm_fe_dai_dev_probe,
 	.remove = msm_fe_dai_dev_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-dai-q6-hdmi.c
===================================================================
--- msm.orig/sound/soc/msm/msm-dai-q6-hdmi.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-dai-q6-hdmi.c	2012-09-14 19:06:53.643212530 -0400
@@ -271,7 +271,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_dai_q6_hdmi_driver = {
+static struct platform_driver msm_dai_q6_hdmi_driver  __refdata =  {
 	.probe  = msm_dai_q6_hdmi_dev_probe,
 	.remove = msm_dai_q6_hdmi_dev_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-dai-stub.c
===================================================================
--- msm.orig/sound/soc/msm/msm-dai-stub.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-dai-stub.c	2012-09-14 19:06:53.643212530 -0400
@@ -72,7 +72,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_dai_stub_driver = {
+static struct platform_driver msm_dai_stub_driver  __refdata =  {
 	.probe  = msm_dai_stub_dev_probe,
 	.remove = msm_dai_stub_dev_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-multi-ch-pcm-q6.c
===================================================================
--- msm.orig/sound/soc/msm/msm-multi-ch-pcm-q6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-multi-ch-pcm-q6.c	2012-09-14 19:06:53.643212530 -0400
@@ -821,7 +821,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-multi-ch-pcm-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-mvs.c
===================================================================
--- msm.orig/sound/soc/msm/msm-mvs.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-mvs.c	2012-09-14 19:09:38.125144209 -0400
@@ -898,7 +898,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __refdata =  {
 	.driver = {
 		.name = "msm-mvs-audio",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-pcm-afe.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-afe.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-afe.c	2012-09-14 19:06:53.643212530 -0400
@@ -592,7 +592,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_afe_driver = {
+static struct platform_driver msm_afe_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-afe",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-pcm-routing.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-routing.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-routing.c	2012-09-14 19:06:53.643212530 -0400
@@ -2813,7 +2813,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_routing_pcm_driver = {
+static struct platform_driver msm_routing_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-routing",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-pcm-voip.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-voip.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-voip.c	2012-09-14 19:06:53.695211879 -0400
@@ -1112,7 +1112,7 @@
 	return ret;
 }
 
-static struct snd_soc_platform_driver msm_soc_platform = {
+static struct snd_soc_platform_driver msm_soc_platform __devinitdata = {
 	.ops		= &msm_pcm_ops,
 	.pcm_new	= msm_asoc_pcm_new,
 	.probe		= msm_pcm_voip_probe,
@@ -1131,7 +1131,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-voip-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-voip.c
===================================================================
--- msm.orig/sound/soc/msm/msm-voip.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-voip.c	2012-09-14 19:09:17.485404437 -0400
@@ -576,7 +576,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __refdata =  {
 	.driver = {
 		.name = "msm-mvs-audio",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm7kv2-pcm.c
===================================================================
--- msm.orig/sound/soc/msm/msm7kv2-pcm.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm7kv2-pcm.c	2012-09-14 19:09:58.676886076 -0400
@@ -749,7 +749,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __refdata =  {
 	.driver = {
 		.name = "msm-dsp-audio",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm8x60-pcm.c
===================================================================
--- msm.orig/sound/soc/msm/msm8x60-pcm.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm8x60-pcm.c	2012-09-14 19:10:11.628723519 -0400
@@ -781,7 +781,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __refdata =  {
 	.probe = msm_pcm_probe,
 	.remove = __devexit_p(msm_pcm_remove),
 	.driver = {
Index: msm/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c	2012-09-14 19:06:53.643212530 -0400
@@ -642,7 +642,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_compr_dt_match);
 
-static struct platform_driver msm_compr_driver = {
+static struct platform_driver msm_compr_driver  __initdata =  {
 	.driver = {
 		.name = "msm-compr-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-multi-ch-pcm-q6-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-multi-ch-pcm-q6-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-multi-ch-pcm-q6-v2.c	2012-09-14 19:06:53.643212530 -0400
@@ -747,7 +747,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-multi-ch-pcm-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-afe-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-afe-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-afe-v2.c	2012-09-14 19:06:53.643212530 -0400
@@ -554,7 +554,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_afe_driver = {
+static struct platform_driver msm_afe_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-afe",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-lpa-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-lpa-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-lpa-v2.c	2012-09-14 19:06:53.643212530 -0400
@@ -595,7 +595,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_pcm_lpa_dt_match);
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-lpa",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-q6-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-q6-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-q6-v2.c	2012-09-14 19:06:53.643212530 -0400
@@ -701,7 +701,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_pcm_dt_match);
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c	2012-09-14 19:06:53.647212479 -0400
@@ -2175,7 +2175,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_pcm_routing_dt_match);
 
-static struct platform_driver msm_routing_pcm_driver = {
+static struct platform_driver msm_routing_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-routing",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-voice-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-voice-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-voice-v2.c	2012-09-14 19:06:53.647212479 -0400
@@ -486,7 +486,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_voice_dt_match);
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-pcm-voice",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/qdsp6v2/msm-pcm-voip-v2.c
===================================================================
--- msm.orig/sound/soc/msm/qdsp6v2/msm-pcm-voip-v2.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/qdsp6v2/msm-pcm-voip-v2.c	2012-09-14 19:06:53.647212479 -0400
@@ -1143,7 +1143,7 @@
 };
 MODULE_DEVICE_TABLE(of, msm_voip_dt_match);
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver  __initdata =  {
 	.driver = {
 		.name = "msm-voip-dsp",
 		.owner = THIS_MODULE,
Index: msm/drivers/input/touchscreen/cyttsp_i2c.c
===================================================================
--- msm.orig/drivers/input/touchscreen/cyttsp_i2c.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/cyttsp_i2c.c	2012-09-14 19:06:53.647212479 -0400
@@ -117,7 +117,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, cyttsp_i2c_id);
 
-static struct i2c_driver cyttsp_i2c_driver = {
+static struct i2c_driver cyttsp_i2c_driver __refdata = {
 	.driver = {
 		.name	= CY_I2C_NAME,
 		.owner	= THIS_MODULE,
Index: msm/drivers/mfd/wcd9xxx-core.c
===================================================================
--- msm.orig/drivers/mfd/wcd9xxx-core.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/wcd9xxx-core.c	2012-09-14 19:06:53.647212479 -0400
@@ -1404,7 +1404,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, tabla_id_table);
 
-static struct i2c_driver tabla_i2c_driver = {
+static struct i2c_driver tabla_i2c_driver __refdata = {
 	.driver                 = {
 		.owner          =       THIS_MODULE,
 		.name           =       "tabla-i2c-core",
Index: msm/drivers/net/wireless/wcnss/wcnss_wlan.c
===================================================================
--- msm.orig/drivers/net/wireless/wcnss/wcnss_wlan.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/net/wireless/wcnss/wcnss_wlan.c	2012-09-14 19:06:53.647212479 -0400
@@ -329,7 +329,7 @@
 }
 
 
-static struct platform_driver wcnss_wlan_ctrl_driver = {
+static struct platform_driver wcnss_wlan_ctrl_driver __refdata = {
 	.driver = {
 		.name	= "WLAN_CTRL",
 		.owner	= THIS_MODULE,
@@ -793,7 +793,7 @@
 };
 #endif
 
-static struct platform_driver wcnss_wlan_driver = {
+static struct platform_driver wcnss_wlan_driver __refdata = {
 	.driver = {
 		.name	= DEVICE,
 		.owner	= THIS_MODULE,
Index: msm/drivers/power/smb349.c
===================================================================
--- msm.orig/drivers/power/smb349.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/smb349.c	2012-09-14 19:06:53.647212479 -0400
@@ -678,7 +678,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, smb349_id);
 
-static struct i2c_driver smb349_driver = {
+static struct i2c_driver smb349_driver __refdata = {
 	.driver	= {
 		   .name	= SMB349_NAME,
 		   .owner	= THIS_MODULE,
Index: msm/drivers/usb/misc/mdm_data_bridge.c
===================================================================
--- msm.orig/drivers/usb/misc/mdm_data_bridge.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/misc/mdm_data_bridge.c	2012-09-14 19:06:53.647212479 -0400
@@ -1036,7 +1036,7 @@
 };
 MODULE_DEVICE_TABLE(usb, bridge_ids);
 
-static struct usb_driver bridge_driver = {
+static struct usb_driver bridge_driver __devinitdata = {
 	.name =			"mdm_bridge",
 	.probe =		bridge_probe,
 	.disconnect =		bridge_disconnect,
Index: msm/sound/soc/codecs/cs8427.c
===================================================================
--- msm.orig/sound/soc/codecs/cs8427.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/codecs/cs8427.c	2012-09-14 19:06:53.647212479 -0400
@@ -946,7 +946,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, cs8427_id_table);
 
-static struct i2c_driver cs8427_i2c_driver = {
+static struct i2c_driver cs8427_i2c_driver __refdata = {
 	.driver                 = {
 		.owner          =       THIS_MODULE,
 		.name           =       "cs8427-spdif",
Index: msm/sound/soc/codecs/wcd9310.c
===================================================================
--- msm.orig/sound/soc/codecs/wcd9310.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/codecs/wcd9310.c	2012-09-14 19:06:53.651212429 -0400
@@ -8407,7 +8407,7 @@
 	snd_soc_unregister_codec(&pdev->dev);
 	return 0;
 }
-static struct platform_driver tabla_codec_driver = {
+static struct platform_driver tabla_codec_driver __refdata = {
 	.probe = tabla_probe,
 	.remove = tabla_remove,
 	.driver = {
@@ -8419,7 +8419,7 @@
 	},
 };
 
-static struct platform_driver tabla1x_codec_driver = {
+static struct platform_driver tabla1x_codec_driver __refdata = {
 	.probe = tabla_probe,
 	.remove = tabla_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-dai-q6.c
===================================================================
--- msm.orig/sound/soc/msm/msm-dai-q6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-dai-q6.c	2012-09-14 19:06:53.691211929 -0400
@@ -1488,7 +1488,7 @@
 	.shutdown	= msm_dai_q6_sec_auxpcm_shutdown,
 };
 
-static struct snd_soc_dai_driver msm_dai_q6_i2s_rx_dai = {
+static struct snd_soc_dai_driver msm_dai_q6_i2s_rx_dai __refdata = {
 	.playback = {
 		.rates = SNDRV_PCM_RATE_48000 | SNDRV_PCM_RATE_8000 |
 		SNDRV_PCM_RATE_16000,
@@ -1970,7 +1970,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_dai_q6_driver = {
+static struct platform_driver msm_dai_q6_driver __refdata = {
 	.probe  = msm_dai_q6_dev_probe,
 	.remove = msm_dai_q6_dev_remove,
 	.driver = {
@@ -1979,7 +1979,7 @@
 	},
 };
 
-static struct platform_driver msm_dai_q6_mi2s_driver = {
+static struct platform_driver msm_dai_q6_mi2s_driver __refdata = {
 	.probe  = msm_dai_q6_mi2s_dev_probe,
 	.remove = msm_dai_q6_mi2s_dev_remove,
 	.driver = {
Index: msm/drivers/input/touchscreen/cyttsp-i2c-qc.c
===================================================================
--- msm.orig/drivers/input/touchscreen/cyttsp-i2c-qc.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/cyttsp-i2c-qc.c	2012-09-14 19:06:53.651212429 -0400
@@ -161,7 +161,7 @@
 };
 #endif
 
-static struct i2c_driver cyttsp_driver = {
+static struct i2c_driver cyttsp_driver __refdata = {
 	.driver = {
 		.name = CY_I2C_NAME,
 		.owner = THIS_MODULE,
Index: msm/drivers/video/msm/mipi_tc358764_dsi2lvds.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_tc358764_dsi2lvds.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_tc358764_dsi2lvds.c	2012-09-14 19:06:53.679212081 -0400
@@ -224,7 +224,7 @@
 static u32 d2l_3d_gpio_mode;
 static int d2l_enable_3d;
 static struct i2c_client *d2l_i2c_client;
-static struct i2c_driver d2l_i2c_slave_driver;
+static struct i2c_driver d2l_i2c_slave_driver __refdata;
 
 static int mipi_d2l_init(void);
 static int mipi_d2l_enable_3d(struct msm_fb_data_type *mfd,
@@ -973,7 +973,7 @@
 	return ret;
 }
 
-static struct platform_driver d2l_driver = {
+static struct platform_driver d2l_driver __refdata = {
 	.probe  = mipi_d2l_probe,
 	.remove = __devexit_p(mipi_d2l_remove),
 	.driver = {
Index: msm/include/linux/oprofile.h
===================================================================
--- msm.orig/include/linux/oprofile.h	2012-09-14 19:06:24.000000000 -0400
+++ msm/include/linux/oprofile.h	2012-09-14 19:06:53.651212429 -0400
@@ -84,7 +84,7 @@
  *
  * If an error occurs, the fields should be left untouched.
  */
-int oprofile_arch_init(struct oprofile_operations * ops);
+int __init oprofile_arch_init(struct oprofile_operations * ops);
  
 /**
  * One-time exit/cleanup for the arch.
Index: msm/net/wireless/reg.c
===================================================================
--- msm.orig/net/wireless/reg.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/wireless/reg.c	2012-09-14 19:06:53.651212429 -0400
@@ -2309,7 +2309,7 @@
 	restore_regulatory_settings(true);
 }
 
-int __init regulatory_init(void)
+int regulatory_init(void)
 {
 	int err = 0;
 
Index: msm/net/wireless/reg.h
===================================================================
--- msm.orig/net/wireless/reg.h	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/wireless/reg.h	2012-09-14 19:06:53.651212429 -0400
@@ -27,7 +27,7 @@
 int reg_device_uevent(struct device *dev, struct kobj_uevent_env *env);
 void reg_device_remove(struct wiphy *wiphy);
 
-int __init regulatory_init(void);
+int regulatory_init(void);
 void regulatory_exit(void);
 
 int set_regdom(const struct ieee80211_regdomain *rd);
Index: msm/arch/arm/mach-msm/sysmon.c
===================================================================
--- msm.orig/arch/arm/mach-msm/sysmon.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/sysmon.c	2012-09-14 19:06:53.651212429 -0400
@@ -278,7 +278,7 @@
 	return 0;
 }
 
-static struct platform_driver sysmon_driver = {
+static struct platform_driver sysmon_driver __refdata = {
 	.probe		= sysmon_probe,
 	.remove		= __devexit_p(sysmon_remove),
 	.driver		= {
Index: msm/arch/arm/oprofile/common.c
===================================================================
--- msm.orig/arch/arm/oprofile/common.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/oprofile/common.c	2012-09-14 19:06:53.651212429 -0400
@@ -116,7 +116,7 @@
 		tail = user_backtrace(tail);
 }
 
-int __init oprofile_arch_init(struct oprofile_operations *ops)
+int oprofile_arch_init(struct oprofile_operations *ops)
 {
 	/* provide backtrace support also in timer mode: */
 	ops->backtrace		= arm_backtrace;
Index: msm/drivers/bluetooth/bluetooth-power.c
===================================================================
--- msm.orig/drivers/bluetooth/bluetooth-power.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/bluetooth/bluetooth-power.c	2012-09-14 19:06:53.651212429 -0400
@@ -108,7 +108,7 @@
 	return 0;
 }
 
-static struct platform_driver bt_power_driver = {
+static struct platform_driver bt_power_driver __refdata = {
 	.probe = bt_power_probe,
 	.remove = __devexit_p(bt_power_remove),
 	.driver = {
Index: msm/drivers/char/dcc_tty.c
===================================================================
--- msm.orig/drivers/char/dcc_tty.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/char/dcc_tty.c	2012-09-14 19:06:53.655212380 -0400
@@ -33,7 +33,7 @@
 static int g_dcc_buffer_head;
 static int g_dcc_buffer_count;
 static unsigned g_dcc_write_delay_usecs = 1;
-static struct tty_driver *g_dcc_tty_driver;
+static struct tty_driver *g_dcc_tty_driver __initdata;
 static struct tty_struct *g_dcc_tty;
 static int g_dcc_tty_open_count;
 
@@ -246,7 +246,7 @@
 }
 
 
-static struct console dcc_console =
+static struct console dcc_console __initdata =
 {
 	.name		= "ttyDCC",
 	.write		= dcc_console_write,
Index: msm/drivers/char/hw_random/msm_rng.c
===================================================================
--- msm.orig/drivers/char/hw_random/msm_rng.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/char/hw_random/msm_rng.c	2012-09-14 19:06:53.655212380 -0400
@@ -237,7 +237,7 @@
 	{}
 };
 
-static struct platform_driver rng_driver = {
+static struct platform_driver rng_driver __refdata = {
 	.probe      = msm_rng_probe,
 	.remove     = __devexit_p(msm_rng_remove),
 	.driver     = {
Index: msm/drivers/char/msm_rotator.c
===================================================================
--- msm.orig/drivers/char/msm_rotator.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/char/msm_rotator.c	2012-09-14 19:06:53.655212380 -0400
@@ -1809,7 +1809,7 @@
 }
 #endif
 
-static struct platform_driver msm_rotator_platform_driver = {
+static struct platform_driver msm_rotator_platform_driver __refdata = {
 	.probe = msm_rotator_probe,
 	.remove = __devexit_p(msm_rotator_remove),
 #ifdef CONFIG_PM
Index: msm/drivers/gpio/pm8xxx-gpio.c
===================================================================
--- msm.orig/drivers/gpio/pm8xxx-gpio.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/gpio/pm8xxx-gpio.c	2012-09-14 19:06:53.655212380 -0400
@@ -435,7 +435,7 @@
 }
 EXPORT_SYMBOL(pm8xxx_gpio_config);
 
-static struct platform_driver pm_gpio_driver = {
+static struct platform_driver pm_gpio_driver __refdata = {
 	.probe		= pm_gpio_probe,
 	.remove		= __devexit_p(pm_gpio_remove),
 	.driver		= {
Index: msm/drivers/gpio/pm8xxx-mpp.c
===================================================================
--- msm.orig/drivers/gpio/pm8xxx-mpp.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/gpio/pm8xxx-mpp.c	2012-09-14 19:06:53.655212380 -0400
@@ -308,7 +308,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_mpp_driver = {
+static struct platform_driver pm8xxx_mpp_driver __refdata = {
 	.probe		= pm8xxx_mpp_probe,
 	.remove		= __devexit_p(pm8xxx_mpp_remove),
 	.driver		= {
Index: msm/drivers/gpu/msm/adreno.c
===================================================================
--- msm.orig/drivers/gpu/msm/adreno.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/gpu/msm/adreno.c	2012-09-14 19:06:53.655212380 -0400
@@ -2459,7 +2459,7 @@
 	.postmortem_dump = adreno_dump,
 };
 
-static struct platform_driver adreno_platform_driver = {
+static struct platform_driver adreno_platform_driver __refdata = {
 	.probe = adreno_probe,
 	.remove = __devexit_p(adreno_remove),
 	.suspend = kgsl_suspend_driver,
Index: msm/drivers/gpu/msm/z180.c
===================================================================
--- msm.orig/drivers/gpu/msm/z180.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/gpu/msm/z180.c	2012-09-14 19:06:53.659212331 -0400
@@ -941,7 +941,7 @@
 };
 MODULE_DEVICE_TABLE(platform, z180_id_table);
 
-static struct platform_driver z180_platform_driver = {
+static struct platform_driver z180_platform_driver __refdata = {
 	.probe = z180_probe,
 	.remove = __devexit_p(z180_remove),
 	.suspend = kgsl_suspend_driver,
Index: msm/drivers/hwmon/msm_adc.c
===================================================================
--- msm.orig/drivers/hwmon/msm_adc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/hwmon/msm_adc.c	2012-09-14 19:06:53.659212331 -0400
@@ -1384,7 +1384,7 @@
 	return rc;
 }
 
-static struct platform_driver msm_adc_rpcrouter_remote_driver = {
+static struct platform_driver msm_adc_rpcrouter_remote_driver __devinitdata = {
 	.probe          = msm_rpc_adc_init,
 	.driver         = {
 		.name   = MSM_ADC_DALRPC_PORT_NAME,
@@ -1506,7 +1506,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_adc_driver = {
+static struct platform_driver msm_adc_driver __refdata = {
 	.probe = msm_adc_probe,
 	.remove = __devexit_p(msm_adc_remove),
 	.driver = {
Index: msm/drivers/i2c/busses/i2c-qup.c
===================================================================
--- msm.orig/drivers/i2c/busses/i2c-qup.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/i2c/busses/i2c-qup.c	2012-09-14 19:06:53.659212331 -0400
@@ -1502,7 +1502,7 @@
 	{}
 };
 
-static struct platform_driver qup_i2c_driver = {
+static struct platform_driver qup_i2c_driver __refdata = {
 	.probe		= qup_i2c_probe,
 	.remove		= __devexit_p(qup_i2c_remove),
 	.driver		= {
Index: msm/drivers/input/keyboard/gpio_keys.c
===================================================================
--- msm.orig/drivers/input/keyboard/gpio_keys.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/keyboard/gpio_keys.c	2012-09-14 19:06:53.659212331 -0400
@@ -816,7 +816,7 @@
 
 static SIMPLE_DEV_PM_OPS(gpio_keys_pm_ops, gpio_keys_suspend, gpio_keys_resume);
 
-static struct platform_driver gpio_keys_device_driver = {
+static struct platform_driver gpio_keys_device_driver __refdata = {
 	.probe		= gpio_keys_probe,
 	.remove		= __devexit_p(gpio_keys_remove),
 	.driver		= {
Index: msm/drivers/input/keyboard/pmic8xxx-keypad.c
===================================================================
--- msm.orig/drivers/input/keyboard/pmic8xxx-keypad.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/keyboard/pmic8xxx-keypad.c	2012-09-14 19:06:53.659212331 -0400
@@ -781,7 +781,7 @@
 static SIMPLE_DEV_PM_OPS(pm8xxx_kp_pm_ops,
 			 pmic8xxx_kp_suspend, pmic8xxx_kp_resume);
 
-static struct platform_driver pmic8xxx_kp_driver = {
+static struct platform_driver pmic8xxx_kp_driver __refdata = {
 	.probe		= pmic8xxx_kp_probe,
 	.remove		= __devexit_p(pmic8xxx_kp_remove),
 	.driver		= {
Index: msm/drivers/input/misc/pmic8058-othc.c
===================================================================
--- msm.orig/drivers/input/misc/pmic8058-othc.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/misc/pmic8058-othc.c	2012-09-14 19:06:53.659212331 -0400
@@ -1155,7 +1155,7 @@
 	return rc;
 }
 
-static struct platform_driver pm8058_othc_driver = {
+static struct platform_driver pm8058_othc_driver __refdata = {
 	.driver = {
 		.name = "pm8058-othc",
 		.owner = THIS_MODULE,
Index: msm/drivers/input/touchscreen/atmel_maxtouch.c
===================================================================
--- msm.orig/drivers/input/touchscreen/atmel_maxtouch.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/atmel_maxtouch.c	2012-09-14 19:06:53.659212331 -0400
@@ -2299,7 +2299,7 @@
 
 MODULE_DEVICE_TABLE(i2c, mxt_idtable);
 
-static struct i2c_driver mxt_driver = {
+static struct i2c_driver mxt_driver __refdata = {
 	.driver = {
 		.name	= "maXTouch",
 		.owner  = THIS_MODULE,
Index: msm/drivers/input/touchscreen/atmel_mxt_ts.c
===================================================================
--- msm.orig/drivers/input/touchscreen/atmel_mxt_ts.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/atmel_mxt_ts.c	2012-09-14 19:06:53.659212331 -0400
@@ -2782,7 +2782,7 @@
 #define mxt_match_table NULL
 #endif
 
-static struct i2c_driver mxt_driver = {
+static struct i2c_driver mxt_driver __refdata = {
 	.driver = {
 		.name	= "atmel_mxt_ts",
 		.owner	= THIS_MODULE,
Index: msm/drivers/input/touchscreen/cy8c_tmg_ts.c
===================================================================
--- msm.orig/drivers/input/touchscreen/cy8c_tmg_ts.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/cy8c_tmg_ts.c	2012-09-14 19:06:53.659212331 -0400
@@ -428,7 +428,7 @@
 	{}
 };
 
-static struct i2c_driver cy8c_ts_driver = {
+static struct i2c_driver cy8c_ts_driver __refdata = {
 	.id_table = cy8c_ts_i2c_id,
 	.probe = cy8c_ts_probe,
 	.remove = cy8c_ts_remove,
Index: msm/drivers/input/touchscreen/cy8c_ts.c
===================================================================
--- msm.orig/drivers/input/touchscreen/cy8c_ts.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/input/touchscreen/cy8c_ts.c	2012-09-14 19:06:53.659212331 -0400
@@ -791,7 +791,7 @@
 MODULE_DEVICE_TABLE(i2c, cy8c_ts_id);
 
 
-static struct i2c_driver cy8c_ts_driver = {
+static struct i2c_driver cy8c_ts_driver __refdata = {
 	.driver = {
 		.name = "cy8c_ts",
 		.owner = THIS_MODULE,
Index: msm/drivers/leds/leds-pmic8058.c
===================================================================
--- msm.orig/drivers/leds/leds-pmic8058.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/leds/leds-pmic8058.c	2012-09-14 19:06:53.659212331 -0400
@@ -401,7 +401,7 @@
 	return 0;
 }
 
-static struct platform_driver pmic8058_led_driver = {
+static struct platform_driver pmic8058_led_driver __refdata = {
 	.probe		= pmic8058_led_probe,
 	.remove		= __devexit_p(pmic8058_led_remove),
 	.driver		= {
Index: msm/drivers/md/dm-crypt.c
===================================================================
--- msm.orig/drivers/md/dm-crypt.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/md/dm-crypt.c	2012-09-14 19:06:53.663212281 -0400
@@ -510,12 +510,14 @@
 	struct iv_lmk_private *lmk = &cc->iv_gen_private.lmk;
 	struct {
 		struct shash_desc desc;
-		char ctx[crypto_shash_descsize(lmk->hash_tfm)];
+		char *ctx;
 	} sdesc;
+        char sdesc_ctx[crypto_shash_descsize(lmk->hash_tfm)];
 	struct md5_state md5state;
 	u32 buf[4];
 	int i, r;
 
+	sdesc.ctx = sdesc_ctx;
 	sdesc.desc.tfm = lmk->hash_tfm;
 	sdesc.desc.flags = CRYPTO_TFM_REQ_MAY_SLEEP;
 
Index: msm/drivers/media/radio/radio-tavarua.c
===================================================================
--- msm.orig/drivers/media/radio/radio-tavarua.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/media/radio/radio-tavarua.c	2012-09-14 19:06:53.663212281 -0400
@@ -4580,7 +4580,7 @@
  provide probe() and remove() methods.  They support power management
  and shutdown notifications using the standard conventions.
 */
-static struct platform_driver tavarua_driver = {
+static struct platform_driver tavarua_driver __refdata = {
 	.driver = {
 		.owner  = THIS_MODULE,
 		.name   = "marimba_fm",
Index: msm/drivers/mfd/marimba-core.c
===================================================================
--- msm.orig/drivers/mfd/marimba-core.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/marimba-core.c	2012-09-14 19:06:53.663212281 -0400
@@ -909,7 +909,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, marimba_id_table);
 
-static struct i2c_driver marimba_driver = {
+static struct i2c_driver marimba_driver __refdata = {
 		.driver			= {
 			.owner		=	THIS_MODULE,
 			.name		=	"marimba-core",
Index: msm/drivers/mfd/pm8xxx-batt-alarm.c
===================================================================
--- msm.orig/drivers/mfd/pm8xxx-batt-alarm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8xxx-batt-alarm.c	2012-09-14 19:06:53.663212281 -0400
@@ -778,7 +778,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_batt_alarm_driver = {
+static struct platform_driver pm8xxx_batt_alarm_driver __refdata = {
 	.probe	= pm8xxx_batt_alarm_probe,
 	.remove	= __devexit_p(pm8xxx_batt_alarm_remove),
 	.driver	= {
Index: msm/drivers/mfd/pm8xxx-debug.c
===================================================================
--- msm.orig/drivers/mfd/pm8xxx-debug.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8xxx-debug.c	2012-09-14 19:06:53.663212281 -0400
@@ -189,7 +189,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_debug_driver = {
+static struct platform_driver pm8xxx_debug_driver __refdata = {
 	.probe		= pm8xxx_debug_probe,
 	.remove		= __devexit_p(pm8xxx_debug_remove),
 	.driver		= {
Index: msm/drivers/mfd/pm8xxx-misc.c
===================================================================
--- msm.orig/drivers/mfd/pm8xxx-misc.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pm8xxx-misc.c	2012-09-14 19:06:53.663212281 -0400
@@ -1237,7 +1237,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_misc_driver = {
+static struct platform_driver pm8xxx_misc_driver __refdata = {
 	.probe	= pm8xxx_misc_probe,
 	.remove	= __devexit_p(pm8xxx_misc_remove),
 	.driver	= {
Index: msm/drivers/mfd/pmic8058.c
===================================================================
--- msm.orig/drivers/mfd/pmic8058.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pmic8058.c	2012-09-14 19:06:53.663212281 -0400
@@ -765,7 +765,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8058_driver = {
+static struct platform_driver pm8058_driver __refdata = {
 	.probe		= pm8058_probe,
 	.remove		= __devexit_p(pm8058_remove),
 	.driver		= {
Index: msm/drivers/mfd/pmic8901.c
===================================================================
--- msm.orig/drivers/mfd/pmic8901.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/mfd/pmic8901.c	2012-09-14 19:06:53.663212281 -0400
@@ -355,7 +355,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8901_driver = {
+static struct platform_driver pm8901_driver __refdata = {
 	.probe		= pm8901_probe,
 	.remove		= __devexit_p(pm8901_remove),
 	.driver		= {
Index: msm/drivers/misc/pm8xxx-upl.c
===================================================================
--- msm.orig/drivers/misc/pm8xxx-upl.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/misc/pm8xxx-upl.c	2012-09-14 19:06:53.663212281 -0400
@@ -322,7 +322,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8xxx_upl_driver = {
+static struct platform_driver pm8xxx_upl_driver __refdata = {
 	.probe		= pm8xxx_upl_probe,
 	.remove		= __devexit_p(pm8xxx_upl_remove),
 	.driver		= {
Index: msm/drivers/misc/pmic8058-pwm.c
===================================================================
--- msm.orig/drivers/misc/pmic8058-pwm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/misc/pmic8058-pwm.c	2012-09-14 19:06:53.663212281 -0400
@@ -1057,7 +1057,7 @@
 	return 0;
 }
 
-static struct platform_driver pmic8058_pwm_driver = {
+static struct platform_driver pmic8058_pwm_driver __refdata = {
 	.probe		= pmic8058_pwm_probe,
 	.remove		= __devexit_p(pmic8058_pwm_remove),
 	.driver		= {
Index: msm/drivers/misc/tsif.c
===================================================================
--- msm.orig/drivers/misc/tsif.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/misc/tsif.c	2012-09-14 19:06:53.667212231 -0400
@@ -1401,7 +1401,7 @@
 };
 
 
-static struct platform_driver msm_tsif_driver = {
+static struct platform_driver msm_tsif_driver __refdata = {
 	.probe          = msm_tsif_probe,
 	.remove         = __exit_p(msm_tsif_remove),
 	.driver         = {
Index: msm/drivers/oprofile/oprofilefs.c
===================================================================
--- msm.orig/drivers/oprofile/oprofilefs.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/oprofile/oprofilefs.c	2012-09-14 19:06:53.667212231 -0400
@@ -268,13 +268,13 @@
 };
 
 
-int __init oprofilefs_register(void)
+int oprofilefs_register(void)
 {
 	return register_filesystem(&oprofilefs_type);
 }
 
 
-void __exit oprofilefs_unregister(void)
+void oprofilefs_unregister(void)
 {
 	unregister_filesystem(&oprofilefs_type);
 }
Index: msm/drivers/platform/msm/ssbi.c
===================================================================
--- msm.orig/drivers/platform/msm/ssbi.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/platform/msm/ssbi.c	2012-09-14 19:06:53.667212231 -0400
@@ -414,7 +414,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_ssbi_driver = {
+static struct platform_driver msm_ssbi_driver __refdata = {
 	.probe		= msm_ssbi_probe,
 	.remove		= __exit_p(msm_ssbi_remove),
 	.driver		= {
Index: msm/drivers/power/isl9519q.c
===================================================================
--- msm.orig/drivers/power/isl9519q.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/isl9519q.c	2012-09-14 19:06:53.667212231 -0400
@@ -817,7 +817,7 @@
 };
 #endif
 
-static struct i2c_driver isl9519q_driver = {
+static struct i2c_driver isl9519q_driver __refdata = {
 	.driver = {
 		   .name = "isl9519q",
 		   .owner = THIS_MODULE,
Index: msm/drivers/power/msm_charger.c
===================================================================
--- msm.orig/drivers/power/msm_charger.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/msm_charger.c	2012-09-14 19:06:53.667212231 -0400
@@ -1217,7 +1217,7 @@
 static SIMPLE_DEV_PM_OPS(msm_charger_pm_ops,
 		msm_charger_suspend, msm_charger_resume);
 
-static struct platform_driver msm_charger_driver = {
+static struct platform_driver msm_charger_driver __refdata = {
 	.probe = msm_charger_probe,
 	.remove = __devexit_p(msm_charger_remove),
 	.driver = {
Index: msm/drivers/power/pm8058_usb_fix.c
===================================================================
--- msm.orig/drivers/power/pm8058_usb_fix.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/pm8058_usb_fix.c	2012-09-14 19:06:53.667212231 -0400
@@ -329,7 +329,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8058_charger_driver = {
+static struct platform_driver pm8058_charger_driver __refdata = {
 	.probe = pm8058_charger_probe,
 	.remove = __devexit_p(pm8058_charger_remove),
 	.driver = {
Index: msm/drivers/power/pmic8058-charger.c
===================================================================
--- msm.orig/drivers/power/pmic8058-charger.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/pmic8058-charger.c	2012-09-14 19:06:53.667212231 -0400
@@ -2019,7 +2019,7 @@
 	return rc;
 }
 
-static struct platform_driver pm8058_charger_driver = {
+static struct platform_driver pm8058_charger_driver __refdata = {
 	.probe = pm8058_charger_probe,
 	.remove = __devexit_p(pm8058_charger_remove),
 	.driver = {
Index: msm/drivers/power/smb137b.c
===================================================================
--- msm.orig/drivers/power/smb137b.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/power/smb137b.c	2012-09-14 19:06:53.667212231 -0400
@@ -826,7 +826,7 @@
 };
 MODULE_DEVICE_TABLE(i2c, smb137b_id);
 
-static struct i2c_driver smb137b_driver = {
+static struct i2c_driver smb137b_driver __refdata = {
 	.driver = {
 		   .name = "smb137b",
 		   .owner = THIS_MODULE,
Index: msm/drivers/regulator/dummy.c
===================================================================
--- msm.orig/drivers/regulator/dummy.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/regulator/dummy.c	2012-09-14 19:06:53.667212231 -0400
@@ -52,7 +52,7 @@
 	return 0;
 }
 
-static struct platform_driver dummy_regulator_driver = {
+static struct platform_driver dummy_regulator_driver __initdata = {
 	.probe		= dummy_regulator_probe,
 	.driver		= {
 		.name		= "reg-dummy",
Index: msm/drivers/regulator/pmic8058-regulator.c
===================================================================
--- msm.orig/drivers/regulator/pmic8058-regulator.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/regulator/pmic8058-regulator.c	2012-09-14 19:06:53.667212231 -0400
@@ -1716,7 +1716,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8058_vreg_driver = {
+static struct platform_driver pm8058_vreg_driver __refdata = {
 	.probe = pm8058_vreg_probe,
 	.remove = __devexit_p(pm8058_vreg_remove),
 	.driver = {
Index: msm/drivers/regulator/pmic8901-regulator.c
===================================================================
--- msm.orig/drivers/regulator/pmic8901-regulator.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/regulator/pmic8901-regulator.c	2012-09-14 19:06:53.667212231 -0400
@@ -978,7 +978,7 @@
 	return 0;
 }
 
-static struct platform_driver pm8901_vreg_driver = {
+static struct platform_driver pm8901_vreg_driver __refdata = {
 	.probe = pm8901_vreg_probe,
 	.remove = __devexit_p(pm8901_vreg_remove),
 	.driver = {
Index: msm/drivers/rtc/rtc-pm8xxx.c
===================================================================
--- msm.orig/drivers/rtc/rtc-pm8xxx.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/rtc/rtc-pm8xxx.c	2012-09-14 19:06:53.667212231 -0400
@@ -587,7 +587,7 @@
 	}
 }
 
-static struct platform_driver pm8xxx_rtc_driver = {
+static struct platform_driver pm8xxx_rtc_driver __refdata = {
 	.probe		= pm8xxx_rtc_probe,
 	.remove		= __devexit_p(pm8xxx_rtc_remove),
 	.shutdown	= pm8xxx_rtc_shutdown,
Index: msm/drivers/slimbus/slimbus.c
===================================================================
--- msm.orig/drivers/slimbus/slimbus.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/slimbus/slimbus.c	2012-09-14 19:06:53.667212231 -0400
@@ -2201,7 +2201,7 @@
 				}
 			}
 			/* schedule 4k family channels */
-			while (coeff1 < ctrl->sched.num_cc1 &&
+			while (slc1 && coeff1 < ctrl->sched.num_cc1 &&
 				curexp == (int)slc1->rootexp + expshft) {
 				/* searchorder effective when opensl valid */
 				static const int srcho[] = { 5, 2, 4, 1, 3, 0 };
Index: msm/drivers/spi/spidev.c
===================================================================
--- msm.orig/drivers/spi/spidev.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/spi/spidev.c	2012-09-14 19:06:53.667212231 -0400
@@ -680,7 +680,7 @@
 	return 0;
 }
 
-static struct spi_driver spidev_spi_driver = {
+static struct spi_driver spidev_spi_driver __refdata = {
 	.driver = {
 		.name =		"spidev",
 		.owner =	THIS_MODULE,
Index: msm/drivers/thermal/pm8xxx-tm.c
===================================================================
--- msm.orig/drivers/thermal/pm8xxx-tm.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/thermal/pm8xxx-tm.c	2012-09-14 19:06:53.667212231 -0400
@@ -696,7 +696,7 @@
 #define PM8XXX_TM_PM_OPS	NULL
 #endif
 
-static struct platform_driver pm8xxx_tm_driver = {
+static struct platform_driver pm8xxx_tm_driver __refdata = {
 	.probe	= pm8xxx_tm_probe,
 	.remove	= __devexit_p(pm8xxx_tm_remove),
 	.driver	= {
Index: msm/drivers/tty/serial/msm_serial_hs.c
===================================================================
--- msm.orig/drivers/tty/serial/msm_serial_hs.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/tty/serial/msm_serial_hs.c	2012-09-14 19:06:53.667212231 -0400
@@ -2176,7 +2176,7 @@
 	.runtime_idle    = msm_hs_runtime_idle,
 };
 
-static struct platform_driver msm_serial_hs_platform_driver = {
+static struct platform_driver msm_serial_hs_platform_driver __refdata = {
 	.probe	= msm_hs_probe,
 	.remove = __devexit_p(msm_hs_remove),
 	.driver = {
Index: msm/drivers/tty/serial/msm_serial_hs_lite.c
===================================================================
--- msm.orig/drivers/tty/serial/msm_serial_hs_lite.c	2012-09-14 19:06:24.000000000 -0400
+++ msm/drivers/tty/serial/msm_serial_hs_lite.c	2012-09-14 19:06:53.667212231 -0400
@@ -1239,7 +1239,7 @@
 
 static struct uart_driver msm_hsl_uart_driver;
 
-static struct console msm_hsl_console = {
+static struct console msm_hsl_console __refdata = {
 	.name = "ttyHSL",
 	.write = msm_hsl_console_write,
 	.device = uart_console_device,
@@ -1533,7 +1533,7 @@
 	.runtime_resume = msm_hsl_runtime_resume,
 };
 
-static struct platform_driver msm_hsl_platform_driver = {
+static struct platform_driver msm_hsl_platform_driver __refdata = {
 	.probe = msm_serial_hsl_probe,
 	.remove = __devexit_p(msm_serial_hsl_remove),
 	.driver = {
Index: msm/drivers/usb/gadget/msm72k_udc.c
===================================================================
--- msm.orig/drivers/usb/gadget/msm72k_udc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/gadget/msm72k_udc.c	2012-09-14 19:06:53.671212181 -0400
@@ -2863,7 +2863,7 @@
 	return usb_free(ui, 0);
 }
 
-static struct platform_driver usb_driver = {
+static struct platform_driver usb_driver __refdata = {
 	.probe = msm72k_probe,
 	.remove = msm72k_remove,
 	.driver = { .name = "msm_hsusb",
Index: msm/drivers/usb/host/ehci-msm.c
===================================================================
--- msm.orig/drivers/usb/host/ehci-msm.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/host/ehci-msm.c	2012-09-14 19:06:53.671212181 -0400
@@ -263,7 +263,7 @@
 				ehci_msm_runtime_idle)
 };
 
-static struct platform_driver ehci_msm_driver = {
+static struct platform_driver ehci_msm_driver __refdata = {
 	.probe	= ehci_msm_probe,
 	.remove	= __devexit_p(ehci_msm_remove),
 	.driver = {
Index: msm/drivers/usb/host/ehci-msm2.c
===================================================================
--- msm.orig/drivers/usb/host/ehci-msm2.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/host/ehci-msm2.c	2012-09-14 19:06:53.671212181 -0400
@@ -1160,7 +1160,7 @@
 };
 #endif
 
-static struct platform_driver ehci_msm2_driver = {
+static struct platform_driver ehci_msm2_driver __refdata = {
 	.probe	= ehci_msm2_probe,
 	.remove	= __devexit_p(ehci_msm2_remove),
 	.driver = {
Index: msm/drivers/usb/host/ehci-msm72k.c
===================================================================
--- msm.orig/drivers/usb/host/ehci-msm72k.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/host/ehci-msm72k.c	2012-09-14 19:06:53.671212181 -0400
@@ -804,7 +804,7 @@
 	.runtime_idle = ehci_msm_runtime_idle
 };
 
-static struct platform_driver ehci_msm_driver = {
+static struct platform_driver ehci_msm_driver __refdata = {
 	.probe	= ehci_msm_probe,
 	.remove	= __exit_p(ehci_msm_remove),
 	.driver	= {.name = "msm_hsusb_host",
Index: msm/drivers/usb/otg/msm72k_otg.c
===================================================================
--- msm.orig/drivers/usb/otg/msm72k_otg.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/otg/msm72k_otg.c	2012-09-14 19:06:53.671212181 -0400
@@ -3009,7 +3009,7 @@
 	.runtime_idle = msm_otg_runtime_idle,
 };
 
-static struct platform_driver msm_otg_driver = {
+static struct platform_driver msm_otg_driver __devexitdata = {
 	.remove = __exit_p(msm_otg_remove),
 	.driver = {
 		.name = DRIVER_NAME,
Index: msm/drivers/usb/otg/msm_otg.c
===================================================================
--- msm.orig/drivers/usb/otg/msm_otg.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/usb/otg/msm_otg.c	2012-09-14 19:06:53.671212181 -0400
@@ -3937,7 +3937,7 @@
 	{}
 };
 
-static struct platform_driver msm_otg_driver = {
+static struct platform_driver msm_otg_driver __devexitdata = {
 	.remove = __devexit_p(msm_otg_remove),
 	.driver = {
 		.name = DRIVER_NAME,
Index: msm/drivers/video/msm/ebi2_l2f.c
===================================================================
--- msm.orig/drivers/video/msm/ebi2_l2f.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/ebi2_l2f.c	2012-09-14 19:06:53.671212181 -0400
@@ -516,7 +516,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = epsonQcif_probe,
 	.driver = {
 		.name   = "ebi2_epson_qcif",
Index: msm/drivers/video/msm/ebi2_lcd.c
===================================================================
--- msm.orig/drivers/video/msm/ebi2_lcd.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/ebi2_lcd.c	2012-09-14 19:06:53.671212181 -0400
@@ -52,7 +52,7 @@
 	.runtime_resume = ebi2_lcd_runtime_resume,
 };
 
-static struct platform_driver ebi2_lcd_driver = {
+static struct platform_driver ebi2_lcd_driver __refdata = {
 	.probe = ebi2_lcd_probe,
 	.remove = ebi2_lcd_remove,
 	.suspend = NULL,
Index: msm/drivers/video/msm/ebi2_tmd20.c
===================================================================
--- msm.orig/drivers/video/msm/ebi2_tmd20.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/ebi2_tmd20.c	2012-09-14 19:06:53.671212181 -0400
@@ -1059,7 +1059,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = tmd20qvga_probe,
 	.driver = {
 		.name   = "ebi2_tmd_qvga",
Index: msm/drivers/video/msm/hdmi_msm.c
===================================================================
--- msm.orig/drivers/video/msm/hdmi_msm.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/hdmi_msm.c	2012-09-14 19:06:53.671212181 -0400
@@ -4736,7 +4736,7 @@
 	return rc;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __refdata = {
 	.probe = hdmi_msm_probe,
 	.remove = hdmi_msm_remove,
 	.driver.name = "hdmi_msm",
Index: msm/drivers/video/msm/lcdc.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc.c	2012-09-14 19:06:53.671212181 -0400
@@ -45,7 +45,7 @@
 static struct clk *pixel_mdp_clk; /* drives the lcdc block in mdp */
 static struct clk *pixel_lcdc_clk; /* drives the lcdc interface */
 
-static struct platform_driver lcdc_driver = {
+static struct platform_driver lcdc_driver __refdata = {
 	.probe = lcdc_probe,
 	.remove = lcdc_remove,
 	.suspend = NULL,
Index: msm/drivers/video/msm/lcdc_auo_wvga.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_auo_wvga.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_auo_wvga.c	2012-09-14 19:06:53.671212181 -0400
@@ -305,7 +305,7 @@
 	lcdc_spi_client = NULL;
 	return 0;
 }
-static struct spi_driver lcdc_auo_spi_driver = {
+static struct spi_driver lcdc_auo_spi_driver __refdata = {
 	.driver.name   = LCDC_AUO_SPI_DEVICE_NAME,
 	.driver.owner  = THIS_MODULE,
 	.probe         = lcdc_auo_spi_probe,
Index: msm/drivers/video/msm/lcdc_chimei_wxga.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_chimei_wxga.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_chimei_wxga.c	2012-09-14 19:06:53.671212181 -0400
@@ -161,7 +161,7 @@
 	return rc;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = chimei_probe,
 	.driver = {
 		.name   = "lcdc_chimei_lvds_wxga",
Index: msm/drivers/video/msm/lcdc_gordon.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_gordon.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_gordon.c	2012-09-14 19:06:53.671212181 -0400
@@ -390,7 +390,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = gordon_probe,
 	.driver = {
 		.name   = "lcdc_gordon_vga",
Index: msm/drivers/video/msm/lcdc_nt35582_wvga.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_nt35582_wvga.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_nt35582_wvga.c	2012-09-14 19:06:53.671212181 -0400
@@ -375,7 +375,7 @@
 	return 0;
 }
 
-static struct spi_driver lcdc_nt35582_spi_driver = {
+static struct spi_driver lcdc_nt35582_spi_driver __refdata = {
 	.driver = {
 		.name = LCDC_NT35582_SPI_DEVICE_NAME,
 		.owner = THIS_MODULE,
@@ -384,7 +384,7 @@
 	.remove = __devexit_p(lcdc_nt35582_spi_remove),
 };
 #endif
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe = nt35582_probe,
 	.driver = {
 		.name = LCDC_NT35582_PANEL_NAME,
Index: msm/drivers/video/msm/lcdc_panel.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_panel.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_panel.c	2012-09-14 19:06:53.671212181 -0400
@@ -30,7 +30,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = lcdc_panel_probe,
 	.driver = {
 		.name   = "lcdc_panel",
Index: msm/drivers/video/msm/lcdc_samsung_oled_pt.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_samsung_oled_pt.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_samsung_oled_pt.c	2012-09-14 19:06:53.671212181 -0400
@@ -534,7 +534,7 @@
 	lcdc_spi_client = NULL;
 	return 0;
 }
-static struct spi_driver lcdc_samsung_spi_driver = {
+static struct spi_driver lcdc_samsung_spi_driver __refdata = {
 	.driver.name   = LCDC_SAMSUNG_SPI_DEVICE_NAME,
 	.driver.owner  = THIS_MODULE,
 	.probe         = lcdc_samsung_spi_probe,
@@ -542,7 +542,7 @@
 };
 #endif
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe		= samsung_probe,
 	.driver.name	= "lcdc_samsung_oled",
 };
Index: msm/drivers/video/msm/lcdc_samsung_wsvga.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_samsung_wsvga.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_samsung_wsvga.c	2012-09-14 19:06:53.675212131 -0400
@@ -195,7 +195,7 @@
 }
 #endif
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __refdata = {
 	.probe  = samsung_probe,
 #ifdef CONFIG_FB_MSM_LCDC_DSUB
 	.remove = samsung_remove,
Index: msm/drivers/video/msm/lcdc_sharp_wvga_pt.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_sharp_wvga_pt.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_sharp_wvga_pt.c	2012-09-14 19:06:53.675212131 -0400
@@ -320,7 +320,7 @@
 	.remove        = __devexit_p(lcdc_sharp_spi_remove),
 };
 #endif
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = sharp_probe,
 	.driver = {
 		.name   = "lcdc_sharp_wvga",
Index: msm/drivers/video/msm/lcdc_toshiba_fwvga_pt.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_toshiba_fwvga_pt.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_toshiba_fwvga_pt.c	2012-09-14 19:06:53.675212131 -0400
@@ -387,7 +387,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = toshiba_probe,
 	.driver = {
 		.name   = "lcdc_toshiba_fwvga_pt",
Index: msm/drivers/video/msm/lcdc_toshiba_wvga_pt.c
===================================================================
--- msm.orig/drivers/video/msm/lcdc_toshiba_wvga_pt.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/lcdc_toshiba_wvga_pt.c	2012-09-14 19:06:53.675212131 -0400
@@ -428,7 +428,7 @@
 	.remove        = __devexit_p(lcdc_toshiba_spi_remove),
 };
 #endif
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = toshiba_probe,
 	.driver = {
 		.name   = "lcdc_toshiba_wvga",
Index: msm/drivers/video/msm/mddi.c
===================================================================
--- msm.orig/drivers/video/msm/mddi.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi.c	2012-09-14 19:06:53.675212131 -0400
@@ -93,7 +93,7 @@
 int irq_enabled;
 unsigned char mddi_timer_shutdown_flag;
 
-static struct platform_driver mddi_driver = {
+static struct platform_driver mddi_driver __refdata = {
 	.probe = mddi_probe,
 	.remove = mddi_remove,
 #ifndef CONFIG_HAS_EARLYSUSPEND
Index: msm/drivers/video/msm/mddi_client_dummy.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_client_dummy.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_client_dummy.c	2012-09-14 19:06:53.675212131 -0400
@@ -81,7 +81,7 @@
 	return 0;
 }
 
-static struct platform_driver mddi_client_dummy = {
+static struct platform_driver mddi_client_dummy __refdata = {
 	.probe = mddi_dummy_probe,
 	.remove = mddi_dummy_remove,
 	.driver = { .name = "mddi_c_dummy" },
Index: msm/drivers/video/msm/mddi_client_nt35399.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_client_nt35399.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_client_nt35399.c	2012-09-14 19:06:53.675212131 -0400
@@ -236,7 +236,7 @@
 	return 0;
 }
 
-static struct platform_driver mddi_client_0bda_8a47 = {
+static struct platform_driver mddi_client_0bda_8a47 __refdata = {
 	.probe = mddi_nt35399_probe,
 	.remove = mddi_nt35399_remove,
 	.driver = { .name = "mddi_c_0bda_8a47" },
Index: msm/drivers/video/msm/mddi_client_toshiba.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_client_toshiba.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_client_toshiba.c	2012-09-14 19:06:53.675212131 -0400
@@ -240,7 +240,7 @@
 	return 0;
 }
 
-static struct platform_driver mddi_client_d263_0000 = {
+static struct platform_driver mddi_client_d263_0000 __refdata = {
 	.probe = mddi_toshiba_probe,
 	.remove = mddi_toshiba_remove,
 	.driver = { .name = "mddi_c_d263_0000" },
Index: msm/drivers/video/msm/mddi_ext.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_ext.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_ext.c	2012-09-14 19:06:53.675212131 -0400
@@ -74,7 +74,7 @@
 	.runtime_idle = mddi_ext_runtime_idle,
 };
 
-static struct platform_driver mddi_ext_driver = {
+static struct platform_driver mddi_ext_driver __refdata = {
 	.probe = mddi_ext_probe,
 	.remove = mddi_ext_remove,
 #ifndef CONFIG_HAS_EARLYSUSPEND
Index: msm/drivers/video/msm/mddi_ext_lcd.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_ext_lcd.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_ext_lcd.c	2012-09-14 19:06:53.675212131 -0400
@@ -35,7 +35,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mddi_ext_lcd_probe,
 	.driver = {
 		.name   = "extmddi_svga",
Index: msm/drivers/video/msm/mddi_prism.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_prism.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_prism.c	2012-09-14 19:06:53.675212131 -0400
@@ -38,7 +38,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = prism_probe,
 	.driver = {
 		.name   = "mddi_prism_wvga",
Index: msm/drivers/video/msm/mddi_quickvx.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_quickvx.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_quickvx.c	2012-09-14 19:06:53.675212131 -0400
@@ -609,7 +609,7 @@
 }
 
 /* Driver data structure */
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mddi_quickvx_lcd_probe,
 	.driver	= {
 		.name	= "mddi_quickvx",
Index: msm/drivers/video/msm/mddi_sharp.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_sharp.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_sharp.c	2012-09-14 19:06:53.675212131 -0400
@@ -760,7 +760,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mddi_sharp_probe,
 	.driver = {
 		.name   = "mddi_sharp_qvga",
Index: msm/drivers/video/msm/mddi_toshiba.c
===================================================================
--- msm.orig/drivers/video/msm/mddi_toshiba.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mddi_toshiba.c	2012-09-14 19:06:53.675212131 -0400
@@ -1672,7 +1672,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mddi_toshiba_lcd_probe,
 	.driver = {
 		.name   = "mddi_toshiba",
Index: msm/drivers/video/msm/mdp.c
===================================================================
--- msm.orig/drivers/video/msm/mdp.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mdp.c	2012-09-14 19:06:53.675212131 -0400
@@ -2038,7 +2038,7 @@
 };
 
 
-static struct platform_driver mdp_driver = {
+static struct platform_driver mdp_driver __refdata = {
 	.probe = mdp_probe,
 	.remove = mdp_remove,
 #ifndef CONFIG_HAS_EARLYSUSPEND
Index: msm/drivers/video/msm/mdp4_dtv.c
===================================================================
--- msm.orig/drivers/video/msm/mdp4_dtv.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mdp4_dtv.c	2012-09-14 19:06:53.675212131 -0400
@@ -64,7 +64,7 @@
 	.runtime_resume = mdp4_dtv_runtime_resume,
 };
 
-static struct platform_driver dtv_driver = {
+static struct platform_driver dtv_driver __refdata = {
 	.probe = dtv_probe,
 	.remove = dtv_remove,
 	.suspend = NULL,
Index: msm/drivers/video/msm/mdp4_wfd_writeback.c
===================================================================
--- msm.orig/drivers/video/msm/mdp4_wfd_writeback.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mdp4_wfd_writeback.c	2012-09-14 19:06:53.675212131 -0400
@@ -84,7 +84,7 @@
 	return rc;
 }
 
-static struct platform_driver writeback_driver = {
+static struct platform_driver writeback_driver __devinitdata = {
 	.probe = writeback_probe,
 	.driver = {
 		.name = "writeback",
Index: msm/drivers/video/msm/mdp4_wfd_writeback_panel.c
===================================================================
--- msm.orig/drivers/video/msm/mdp4_wfd_writeback_panel.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mdp4_wfd_writeback_panel.c	2012-09-14 19:06:53.675212131 -0400
@@ -52,7 +52,7 @@
 	.id = 1,
 	.dev.platform_data = &writeback_msm_panel_data,
 };
-static struct platform_driver writeback_panel_driver = {
+static struct platform_driver writeback_panel_driver __devinitdata = {
 	.probe = writeback_panel_probe,
 	.driver = {
 		.name = "writeback_panel"
Index: msm/drivers/video/msm/mdp_lcdc.c
===================================================================
--- msm.orig/drivers/video/msm/mdp_lcdc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mdp_lcdc.c	2012-09-14 19:06:53.675212131 -0400
@@ -390,7 +390,7 @@
 	return 0;
 }
 
-static struct platform_driver mdp_lcdc_driver = {
+static struct platform_driver mdp_lcdc_driver __refdata = {
 	.probe = mdp_lcdc_probe,
 	.remove = mdp_lcdc_remove,
 	.driver = {
Index: msm/drivers/video/msm/mipi_NT35510.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_NT35510.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_NT35510.c	2012-09-14 19:06:53.675212131 -0400
@@ -613,7 +613,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __initdata = {
 	.probe  = mipi_nt35510_lcd_probe,
 	.driver = {
 		.name   = "mipi_NT35510",
Index: msm/drivers/video/msm/mipi_dsi.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_dsi.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_dsi.c	2012-09-14 19:06:53.675212131 -0400
@@ -52,7 +52,7 @@
 
 static int vsync_gpio = -1;
 
-static struct platform_driver mipi_dsi_driver = {
+static struct platform_driver mipi_dsi_driver __refdata = {
 	.probe = mipi_dsi_probe,
 	.remove = mipi_dsi_remove,
 	.shutdown = NULL,
Index: msm/drivers/video/msm/mipi_novatek.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_novatek.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_novatek.c	2012-09-14 19:06:53.675212131 -0400
@@ -119,7 +119,7 @@
 	panel_3d_spi_client = NULL;
 	return 0;
 }
-static struct spi_driver panel_3d_spi_driver = {
+static struct spi_driver panel_3d_spi_driver __refdata = {
 	.probe         = panel_3d_spi_probe,
 	.remove        = __devexit_p(panel_3d_spi_remove),
 	.driver		   = {
@@ -513,7 +513,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mipi_novatek_lcd_probe,
 	.driver = {
 		.name   = "mipi_novatek",
Index: msm/drivers/video/msm/mipi_renesas.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_renesas.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_renesas.c	2012-09-14 19:06:53.675212131 -0400
@@ -1196,7 +1196,7 @@
 		pr_err("%s(): Backlight level set failed", __func__);
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __refdata = {
 	.probe  = mipi_renesas_lcd_probe,
 	.driver = {
 		.name   = "mipi_renesas",
Index: msm/drivers/video/msm/mipi_simulator.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_simulator.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_simulator.c	2012-09-14 19:06:53.675212131 -0400
@@ -98,7 +98,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mipi_simulator_lcd_probe,
 	.driver = {
 		.name   = "mipi_simulator",
Index: msm/drivers/video/msm/mipi_toshiba.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_toshiba.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_toshiba.c	2012-09-14 19:06:53.679212081 -0400
@@ -286,7 +286,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __devinitdata = {
 	.probe  = mipi_toshiba_lcd_probe,
 	.driver = {
 		.name   = "mipi_toshiba",
Index: msm/drivers/video/msm/mipi_truly.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_truly.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_truly.c	2012-09-14 19:06:53.679212081 -0400
@@ -194,7 +194,7 @@
 	return 0;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __initdata = {
 	.probe  = mipi_truly_lcd_probe,
 	.driver = {
 		.name   = "mipi_truly",
Index: msm/drivers/video/msm/mipi_truly_tft540960_1_e.c
===================================================================
--- msm.orig/drivers/video/msm/mipi_truly_tft540960_1_e.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/mipi_truly_tft540960_1_e.c	2012-09-14 19:06:53.679212081 -0400
@@ -795,7 +795,7 @@
 	return rc;
 }
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __initdata = {
 	.probe  = mipi_truly_lcd_probe,
 	.driver = {
 		.name   = "mipi_truly_tft540960_1_e",
Index: msm/drivers/video/msm/msm_fb.c
===================================================================
--- msm.orig/drivers/video/msm/msm_fb.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/msm_fb.c	2012-09-14 19:06:53.679212081 -0400
@@ -720,7 +720,7 @@
 #endif
 };
 
-static struct platform_driver msm_fb_driver = {
+static struct platform_driver msm_fb_driver __refdata = {
 	.probe = msm_fb_probe,
 	.remove = msm_fb_remove,
 #ifndef CONFIG_HAS_EARLYSUSPEND
Index: msm/drivers/video/msm/tvenc.c
===================================================================
--- msm.orig/drivers/video/msm/tvenc.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/tvenc.c	2012-09-14 19:06:53.679212081 -0400
@@ -75,7 +75,7 @@
 	.runtime_resume = tvenc_runtime_resume,
 };
 
-static struct platform_driver tvenc_driver = {
+static struct platform_driver tvenc_driver __refdata = {
 	.probe = tvenc_probe,
 	.remove = tvenc_remove,
 	.suspend = NULL,
Index: msm/drivers/video/msm/tvout_msm.c
===================================================================
--- msm.orig/drivers/video/msm/tvout_msm.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/tvout_msm.c	2012-09-14 19:06:53.679212081 -0400
@@ -565,7 +565,7 @@
 	.resume = tvout_device_pm_resume,
 };
 
-static struct platform_driver this_driver = {
+static struct platform_driver this_driver __refdata = {
 	.probe  = tvout_probe,
 	.remove = tvout_remove,
 	.driver = {
Index: msm/drivers/video/msm/vidc/common/init/vidc_init.c
===================================================================
--- msm.orig/drivers/video/msm/vidc/common/init/vidc_init.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/drivers/video/msm/vidc/common/init/vidc_init.c	2012-09-14 19:06:53.679212081 -0400
@@ -202,7 +202,7 @@
 	.runtime_resume = vidc_runtime_resume,
 };
 
-static struct platform_driver msm_vidc_720p_platform_driver = {
+static struct platform_driver msm_vidc_720p_platform_driver __refdata = {
 	.probe = vidc_720p_probe,
 	.remove = vidc_720p_remove,
 	.driver = {
Index: msm/include/net/net_namespace.h
===================================================================
--- msm.orig/include/net/net_namespace.h	2012-09-14 19:06:24.000000000 -0400
+++ msm/include/net/net_namespace.h	2012-09-14 19:06:53.679212081 -0400
@@ -240,10 +240,12 @@
 #define __net_init
 #define __net_exit
 #define __net_initdata
+#define __net_initconst
 #else
 #define __net_init	__init
 #define __net_exit	__exit_refok
 #define __net_initdata	__initdata
+#define __net_initconst	__initconst
 #endif
 
 struct pernet_operations {
Index: msm/net/core/fib_rules.c
===================================================================
--- msm.orig/net/core/fib_rules.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/core/fib_rules.c	2012-09-14 19:06:53.679212081 -0400
@@ -737,7 +737,7 @@
 	return 0;
 }
 
-static struct pernet_operations fib_rules_net_ops = {
+static struct pernet_operations fib_rules_net_ops __initdata = {
 	.init = fib_rules_net_init,
 };
 
Index: msm/net/core/rtnetlink.c
===================================================================
--- msm.orig/net/core/rtnetlink.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/core/rtnetlink.c	2012-09-14 19:06:53.679212081 -0400
@@ -2113,7 +2113,7 @@
 	net->rtnl = NULL;
 }
 
-static struct pernet_operations rtnetlink_net_ops = {
+static struct pernet_operations rtnetlink_net_ops __net_initdata = {
 	.init = rtnetlink_net_init,
 	.exit = rtnetlink_net_exit,
 };
Index: msm/net/ipv4/arp.c
===================================================================
--- msm.orig/net/ipv4/arp.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/arp.c	2012-09-14 19:06:53.679212081 -0400
@@ -1405,7 +1405,7 @@
 			    sizeof(struct neigh_seq_state));
 }
 
-static const struct file_operations arp_seq_fops = {
+static const struct file_operations arp_seq_fops __net_initconst = {
 	.owner		= THIS_MODULE,
 	.open           = arp_seq_open,
 	.read           = seq_read,
@@ -1426,7 +1426,7 @@
 	proc_net_remove(net, "arp");
 }
 
-static struct pernet_operations arp_net_ops = {
+static struct pernet_operations arp_net_ops __net_initdata = {
 	.init = arp_net_init,
 	.exit = arp_net_exit,
 };
Index: msm/net/ipv4/fib_frontend.c
===================================================================
--- msm.orig/net/ipv4/fib_frontend.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/fib_frontend.c	2012-09-14 19:06:53.679212081 -0400
@@ -1116,7 +1116,7 @@
 	ip_fib_net_exit(net);
 }
 
-static struct pernet_operations fib_net_ops = {
+static struct pernet_operations fib_net_ops __net_initdata = {
 	.init = fib_net_init,
 	.exit = fib_net_exit,
 };
Index: msm/net/ipv4/ip_fragment.c
===================================================================
--- msm.orig/net/ipv4/ip_fragment.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/ip_fragment.c	2012-09-14 19:06:53.679212081 -0400
@@ -852,7 +852,7 @@
 	inet_frags_exit_net(&net->ipv4.frags, &ip4_frags);
 }
 
-static struct pernet_operations ip4_frags_ops = {
+static struct pernet_operations ip4_frags_ops __net_initdata = {
 	.init = ipv4_frags_init_net,
 	.exit = ipv4_frags_exit_net,
 };
Index: msm/net/ipv4/netfilter/arp_tables.c
===================================================================
--- msm.orig/net/ipv4/netfilter/arp_tables.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/netfilter/arp_tables.c	2012-09-14 19:06:53.679212081 -0400
@@ -1865,7 +1865,7 @@
 	xt_proto_fini(net, NFPROTO_ARP);
 }
 
-static struct pernet_operations arp_tables_net_ops = {
+static struct pernet_operations arp_tables_net_ops __refdata = {
 	.init = arp_tables_net_init,
 	.exit = arp_tables_net_exit,
 };
Index: msm/net/ipv4/netfilter/ip_tables.c
===================================================================
--- msm.orig/net/ipv4/netfilter/ip_tables.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/netfilter/ip_tables.c	2012-09-14 19:06:53.683212031 -0400
@@ -2216,7 +2216,7 @@
 	xt_proto_fini(net, NFPROTO_IPV4);
 }
 
-static struct pernet_operations ip_tables_net_ops = {
+static struct pernet_operations ip_tables_net_ops __net_initdata = {
 	.init = ip_tables_net_init,
 	.exit = ip_tables_net_exit,
 };
Index: msm/net/ipv4/netfilter/iptable_filter.c
===================================================================
--- msm.orig/net/ipv4/netfilter/iptable_filter.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/netfilter/iptable_filter.c	2012-09-14 19:06:53.683212031 -0400
@@ -79,7 +79,7 @@
 	ipt_unregister_table(net, net->ipv4.iptable_filter);
 }
 
-static struct pernet_operations iptable_filter_net_ops = {
+static struct pernet_operations iptable_filter_net_ops __refdata = {
 	.init = iptable_filter_net_init,
 	.exit = iptable_filter_net_exit,
 };
Index: msm/net/ipv4/netfilter/nf_nat_core.c
===================================================================
--- msm.orig/net/ipv4/netfilter/nf_nat_core.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/netfilter/nf_nat_core.c	2012-09-14 19:06:53.683212031 -0400
@@ -681,7 +681,7 @@
 	nf_ct_free_hashtable(net->ipv4.nat_bysource, net->ipv4.nat_htable_size);
 }
 
-static struct pernet_operations nf_nat_net_ops = {
+static struct pernet_operations nf_nat_net_ops __net_initdata = {
 	.init = nf_nat_net_init,
 	.exit = nf_nat_net_exit,
 };
Index: msm/net/ipv4/tcp_ipv4.c
===================================================================
--- msm.orig/net/ipv4/tcp_ipv4.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/tcp_ipv4.c	2012-09-14 19:06:53.683212031 -0400
@@ -2603,7 +2603,7 @@
 	tcp_proc_unregister(net, &tcp4_seq_afinfo);
 }
 
-static struct pernet_operations tcp4_net_ops = {
+static struct pernet_operations tcp4_net_ops __net_initdata = {
 	.init = tcp4_proc_init_net,
 	.exit = tcp4_proc_exit_net,
 };
Index: msm/net/ipv4/udp.c
===================================================================
--- msm.orig/net/ipv4/udp.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/udp.c	2012-09-14 19:06:53.683212031 -0400
@@ -2144,7 +2144,7 @@
 	udp_proc_unregister(net, &udp4_seq_afinfo);
 }
 
-static struct pernet_operations udp4_net_ops = {
+static struct pernet_operations udp4_net_ops __net_initdata = {
 	.init = udp4_proc_init_net,
 	.exit = udp4_proc_exit_net,
 };
Index: msm/net/ipv4/udplite.c
===================================================================
--- msm.orig/net/ipv4/udplite.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv4/udplite.c	2012-09-14 19:06:53.683212031 -0400
@@ -104,7 +104,7 @@
 	udp_proc_unregister(net, &udplite4_seq_afinfo);
 }
 
-static struct pernet_operations udplite4_net_ops = {
+static struct pernet_operations udplite4_net_ops __net_initdata = {
 	.init = udplite4_proc_init_net,
 	.exit = udplite4_proc_exit_net,
 };
Index: msm/net/ipv6/addrconf.c
===================================================================
--- msm.orig/net/ipv6/addrconf.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/ipv6/addrconf.c	2012-09-14 19:06:53.683212031 -0400
@@ -3213,7 +3213,7 @@
        proc_net_remove(net, "if_inet6");
 }
 
-static struct pernet_operations if6_proc_net_ops = {
+static struct pernet_operations if6_proc_net_ops __refdata = {
        .init = if6_proc_net_init,
        .exit = if6_proc_net_exit,
 };
@@ -4749,7 +4749,7 @@
 	}
 }
 
-static struct pernet_operations addrconf_ops = {
+static struct pernet_operations addrconf_ops __net_initdata = {
 	.init = addrconf_init_net,
 	.exit = addrconf_exit_net,
 };
Index: msm/net/ipv6/addrlabel.c
===================================================================
--- msm.orig/net/ipv6/addrlabel.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/addrlabel.c	2012-09-14 19:06:53.683212031 -0400
@@ -381,7 +381,7 @@
 	spin_unlock(&ip6addrlbl_table.lock);
 }
 
-static struct pernet_operations ipv6_addr_label_ops = {
+static struct pernet_operations ipv6_addr_label_ops __initdata = {
 	.init = ip6addrlbl_net_init,
 	.exit = ip6addrlbl_net_exit,
 };
Index: msm/net/ipv6/af_inet6.c
===================================================================
--- msm.orig/net/ipv6/af_inet6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/af_inet6.c	2012-09-14 19:06:53.683212031 -0400
@@ -1090,7 +1090,7 @@
 	ipv6_cleanup_mibs(net);
 }
 
-static struct pernet_operations inet6_net_ops = {
+static struct pernet_operations inet6_net_ops __refdata = {
 	.init = inet6_net_init,
 	.exit = inet6_net_exit,
 };
Index: msm/net/ipv6/ip6_fib.c
===================================================================
--- msm.orig/net/ipv6/ip6_fib.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/ip6_fib.c	2012-09-14 19:06:53.683212031 -0400
@@ -1672,7 +1672,7 @@
 	kfree(net->ipv6.rt6_stats);
 }
 
-static struct pernet_operations fib6_net_ops = {
+static struct pernet_operations fib6_net_ops __refdata = {
 	.init = fib6_net_init,
 	.exit = fib6_net_exit,
 };
Index: msm/net/ipv6/ip6_flowlabel.c
===================================================================
--- msm.orig/net/ipv6/ip6_flowlabel.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/ip6_flowlabel.c	2012-09-14 19:06:53.683212031 -0400
@@ -730,7 +730,7 @@
 			    sizeof(struct ip6fl_iter_state));
 }
 
-static const struct file_operations ip6fl_seq_fops = {
+static const struct file_operations ip6fl_seq_fops __net_initconst = {
 	.owner		=	THIS_MODULE,
 	.open		=	ip6fl_seq_open,
 	.read		=	seq_read,
@@ -766,7 +766,7 @@
 	ip6_flowlabel_proc_fini(net);
 }
 
-static struct pernet_operations ip6_flowlabel_net_ops = {
+static struct pernet_operations ip6_flowlabel_net_ops __net_initdata = {
 	.init = ip6_flowlabel_proc_init,
 	.exit = ip6_flowlabel_net_exit,
 };
Index: msm/net/ipv6/mcast.c
===================================================================
--- msm.orig/net/ipv6/mcast.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/mcast.c	2012-09-14 19:06:53.683212031 -0400
@@ -2652,7 +2652,7 @@
 	igmp6_proc_exit(net);
 }
 
-static struct pernet_operations igmp6_net_ops = {
+static struct pernet_operations igmp6_net_ops __net_initdata = {
 	.init = igmp6_net_init,
 	.exit = igmp6_net_exit,
 };
Index: msm/net/ipv6/ndisc.c
===================================================================
--- msm.orig/net/ipv6/ndisc.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/ndisc.c	2012-09-14 19:06:53.683212031 -0400
@@ -1752,7 +1752,7 @@
 	return NOTIFY_DONE;
 }
 
-static struct notifier_block ndisc_netdev_notifier = {
+static struct notifier_block ndisc_netdev_notifier __initdata = {
 	.notifier_call = ndisc_netdev_event,
 };
 
Index: msm/net/ipv6/netfilter/ip6_tables.c
===================================================================
--- msm.orig/net/ipv6/netfilter/ip6_tables.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/netfilter/ip6_tables.c	2012-09-14 19:06:53.683212031 -0400
@@ -2225,7 +2225,7 @@
 	xt_proto_fini(net, NFPROTO_IPV6);
 }
 
-static struct pernet_operations ip6_tables_net_ops = {
+static struct pernet_operations ip6_tables_net_ops __net_initdata = {
 	.init = ip6_tables_net_init,
 	.exit = ip6_tables_net_exit,
 };
Index: msm/net/ipv6/netfilter/ip6table_filter.c
===================================================================
--- msm.orig/net/ipv6/netfilter/ip6table_filter.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/netfilter/ip6table_filter.c	2012-09-14 19:06:53.687211980 -0400
@@ -22,7 +22,7 @@
 			    (1 << NF_INET_FORWARD) | \
 			    (1 << NF_INET_LOCAL_OUT))
 
-static const struct xt_table packet_filter = {
+static const struct xt_table packet_filter __refdata = {
 	.name		= "filter",
 	.valid_hooks	= FILTER_VALID_HOOKS,
 	.me		= THIS_MODULE,
@@ -71,7 +71,7 @@
 	ip6t_unregister_table(net, net->ipv6.ip6table_filter);
 }
 
-static struct pernet_operations ip6table_filter_net_ops = {
+static struct pernet_operations ip6table_filter_net_ops __net_initdata = {
 	.init = ip6table_filter_net_init,
 	.exit = ip6table_filter_net_exit,
 };
Index: msm/net/ipv6/raw.c
===================================================================
--- msm.orig/net/ipv6/raw.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/ipv6/raw.c	2012-09-14 19:06:53.687211980 -0400
@@ -1300,7 +1300,7 @@
 	proc_net_remove(net, "raw6");
 }
 
-static struct pernet_operations raw6_net_ops = {
+static struct pernet_operations raw6_net_ops __net_initdata = {
 	.init = raw6_init_net,
 	.exit = raw6_exit_net,
 };
@@ -1342,7 +1342,7 @@
 #endif
 };
 
-static struct inet_protosw rawv6_protosw = {
+static struct inet_protosw rawv6_protosw __initdata = {
 	.type		= SOCK_RAW,
 	.protocol	= IPPROTO_IP,	/* wild card */
 	.prot		= &rawv6_prot,
Index: msm/net/ipv6/reassembly.c
===================================================================
--- msm.orig/net/ipv6/reassembly.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/reassembly.c	2012-09-14 19:06:53.687211980 -0400
@@ -720,7 +720,7 @@
 	inet_frags_exit_net(&net->ipv6.frags, &ip6_frags);
 }
 
-static struct pernet_operations ip6_frags_ops = {
+static struct pernet_operations ip6_frags_ops __net_initdata = {
 	.init = ipv6_frags_init_net,
 	.exit = ipv6_frags_exit_net,
 };
Index: msm/net/ipv6/route.c
===================================================================
--- msm.orig/net/ipv6/route.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/ipv6/route.c	2012-09-14 19:06:53.687211980 -0400
@@ -2989,7 +2989,7 @@
 	dst_entries_destroy(&net->ipv6.ip6_dst_ops);
 }
 
-static struct pernet_operations ip6_route_net_ops = {
+static struct pernet_operations ip6_route_net_ops __initdata = {
 	.init = ip6_route_net_init,
 	.exit = ip6_route_net_exit,
 };
Index: msm/net/ipv6/sysctl_net_ipv6.c
===================================================================
--- msm.orig/net/ipv6/sysctl_net_ipv6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/sysctl_net_ipv6.c	2012-09-14 19:06:53.687211980 -0400
@@ -129,7 +129,7 @@
 	kfree(ipv6_icmp_table);
 }
 
-static struct pernet_operations ipv6_sysctl_net_ops = {
+static struct pernet_operations ipv6_sysctl_net_ops __net_initdata = {
 	.init = ipv6_sysctl_net_init,
 	.exit = ipv6_sysctl_net_exit,
 };
Index: msm/net/ipv6/tcp_ipv6.c
===================================================================
--- msm.orig/net/ipv6/tcp_ipv6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/tcp_ipv6.c	2012-09-14 19:06:53.687211980 -0400
@@ -2156,7 +2156,7 @@
 	inet_twsk_purge(&tcp_hashinfo, &tcp_death_row, AF_INET6);
 }
 
-static struct pernet_operations tcpv6_net_ops = {
+static struct pernet_operations tcpv6_net_ops __net_initdata = {
 	.init	    = tcpv6_net_init,
 	.exit	    = tcpv6_net_exit,
 	.exit_batch = tcpv6_net_exit_batch,
Index: msm/net/ipv6/udplite.c
===================================================================
--- msm.orig/net/ipv6/udplite.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/ipv6/udplite.c	2012-09-14 19:06:53.687211980 -0400
@@ -123,7 +123,7 @@
 	udp_proc_unregister(net, &udplite6_seq_afinfo);
 }
 
-static struct pernet_operations udplite6_net_ops = {
+static struct pernet_operations udplite6_net_ops __initdata = {
 	.init = udplite6_proc_init_net,
 	.exit = udplite6_proc_exit_net,
 };
Index: msm/net/ipv6/xfrm6_tunnel.c
===================================================================
--- msm.orig/net/ipv6/xfrm6_tunnel.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/ipv6/xfrm6_tunnel.c	2012-09-14 19:06:53.687211980 -0400
@@ -345,7 +345,7 @@
 {
 }
 
-static struct pernet_operations xfrm6_tunnel_net_ops = {
+static struct pernet_operations xfrm6_tunnel_net_ops __refdata = {
 	.init	= xfrm6_tunnel_net_init,
 	.exit	= xfrm6_tunnel_net_exit,
 	.id	= &xfrm6_tunnel_net_id,
Index: msm/net/netfilter/nf_conntrack_proto_dccp.c
===================================================================
--- msm.orig/net/netfilter/nf_conntrack_proto_dccp.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/netfilter/nf_conntrack_proto_dccp.c	2012-09-14 19:06:53.687211980 -0400
@@ -928,7 +928,7 @@
 #endif
 }
 
-static struct pernet_operations dccp_net_ops = {
+static struct pernet_operations dccp_net_ops __net_initdata = {
 	.init = dccp_net_init,
 	.exit = dccp_net_exit,
 	.id   = &dccp_net_id,
Index: msm/net/netfilter/nfnetlink.c
===================================================================
--- msm.orig/net/netfilter/nfnetlink.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/netfilter/nfnetlink.c	2012-09-14 19:06:53.687211980 -0400
@@ -224,7 +224,7 @@
 		netlink_kernel_release(net->nfnl_stash);
 }
 
-static struct pernet_operations nfnetlink_net_ops = {
+static struct pernet_operations nfnetlink_net_ops __net_initdata = {
 	.init		= nfnetlink_net_init,
 	.exit_batch	= nfnetlink_net_exit_batch,
 };
Index: msm/net/netfilter/xt_hashlimit.c
===================================================================
--- msm.orig/net/netfilter/xt_hashlimit.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/netfilter/xt_hashlimit.c	2012-09-14 19:06:53.687211980 -0400
@@ -798,7 +798,7 @@
 	hashlimit_proc_net_exit(net);
 }
 
-static struct pernet_operations hashlimit_net_ops = {
+static struct pernet_operations hashlimit_net_ops __net_initdata = {
 	.init	= hashlimit_net_init,
 	.exit	= hashlimit_net_exit,
 	.id	= &hashlimit_net_id,
Index: msm/net/netlink/genetlink.c
===================================================================
--- msm.orig/net/netlink/genetlink.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/net/netlink/genetlink.c	2012-09-14 19:06:53.687211980 -0400
@@ -897,7 +897,7 @@
 	return 0;
 }
 
-static struct genl_ops genl_ctrl_ops = {
+static struct genl_ops genl_ctrl_ops __initdata = {
 	.cmd		= CTRL_CMD_GETFAMILY,
 	.doit		= ctrl_getfamily,
 	.dumpit		= ctrl_dumpfamily,
@@ -930,7 +930,7 @@
 	net->genl_sock = NULL;
 }
 
-static struct pernet_operations genl_pernet_ops = {
+static struct pernet_operations genl_pernet_ops __initdata = {
 	.init = genl_pernet_init,
 	.exit = genl_pernet_exit,
 };
Index: msm/net/packet/af_packet.c
===================================================================
--- msm.orig/net/packet/af_packet.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/packet/af_packet.c	2012-09-14 19:06:53.687211980 -0400
@@ -3929,7 +3929,7 @@
 	proc_net_remove(net, "packet");
 }
 
-static struct pernet_operations packet_net_ops = {
+static struct pernet_operations packet_net_ops __net_initdata = {
 	.init = packet_net_init,
 	.exit = packet_net_exit,
 };
Index: msm/net/sched/sch_api.c
===================================================================
--- msm.orig/net/sched/sch_api.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/sched/sch_api.c	2012-09-14 19:06:53.687211980 -0400
@@ -1770,7 +1770,7 @@
 	return single_open(file, psched_show, NULL);
 }
 
-static const struct file_operations psched_fops = {
+static const struct file_operations psched_fops __net_initconst = {
 	.owner = THIS_MODULE,
 	.open = psched_open,
 	.read  = seq_read,
@@ -1804,7 +1804,7 @@
 }
 #endif
 
-static struct pernet_operations psched_net_ops = {
+static struct pernet_operations psched_net_ops __initdata = {
 	.init = psched_net_init,
 	.exit = psched_net_exit,
 };
Index: msm/net/sysctl_net.c
===================================================================
--- msm.orig/net/sysctl_net.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/sysctl_net.c	2012-09-14 19:06:53.687211980 -0400
@@ -83,7 +83,7 @@
 	retire_sysctl_set(&net->sysctls);
 }
 
-static struct pernet_operations sysctl_pernet_ops = {
+static struct pernet_operations sysctl_pernet_ops __initdata = {
 	.init = sysctl_net_init,
 	.exit = sysctl_net_exit,
 };
Index: msm/net/unix/af_unix.c
===================================================================
--- msm.orig/net/unix/af_unix.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/unix/af_unix.c	2012-09-14 19:06:53.687211980 -0400
@@ -2400,7 +2400,7 @@
 	proc_net_remove(net, "unix");
 }
 
-static struct pernet_operations unix_net_ops = {
+static struct pernet_operations unix_net_ops __net_initdata = {
 	.init = unix_net_init,
 	.exit = unix_net_exit,
 };
Index: msm/net/wireless/wext-core.c
===================================================================
--- msm.orig/net/wireless/wext-core.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/wireless/wext-core.c	2012-09-14 19:06:53.687211980 -0400
@@ -353,7 +353,7 @@
 	skb_queue_purge(&net->wext_nlevents);
 }
 
-static struct pernet_operations wext_pernet_ops = {
+static struct pernet_operations wext_pernet_ops __initdata = {
 	.init = wext_pernet_init,
 	.exit = wext_pernet_exit,
 };
Index: msm/sound/soc/msm/lpass-dma.c
===================================================================
--- msm.orig/sound/soc/msm/lpass-dma.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/lpass-dma.c	2012-09-14 19:06:53.687211980 -0400
@@ -424,7 +424,7 @@
 	return 0;
 }
 
-static struct platform_driver dai_driver = {
+static struct platform_driver dai_driver __refdata = {
 	.probe = dai_probe,
 	.remove = dai_remove,
 	.driver = {
Index: msm/sound/soc/msm/msm-dai.c
===================================================================
--- msm.orig/sound/soc/msm/msm-dai.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-dai.c	2012-09-14 19:06:53.691211929 -0400
@@ -102,7 +102,7 @@
 	return 0;
 }
 
-static struct platform_driver asoc_codec_dai_driver = {
+static struct platform_driver asoc_codec_dai_driver __refdata = {
 	.probe = asoc_msm_codec_probe,
 	.remove = __devexit_p(asoc_msm_codec_remove),
 	.driver = {
@@ -111,7 +111,7 @@
 	},
 };
 
-static struct platform_driver asoc_cpu_dai_driver = {
+static struct platform_driver asoc_cpu_dai_driver __refdata = {
 	.probe = asoc_pcm_cpu_probe,
 	.remove = __devexit_p(asoc_pcm_cpu_remove),
 	.driver = {
Index: msm/sound/soc/msm/msm-pcm-lpa.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-lpa.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-lpa.c	2012-09-14 19:06:53.691211929 -0400
@@ -587,7 +587,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver __refdata = {
 	.driver = {
 		.name = "msm-pcm-lpa",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-pcm-q6.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-q6.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-q6.c	2012-09-14 19:06:53.691211929 -0400
@@ -722,7 +722,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver __refdata = {
 	.driver = {
 		.name = "msm-pcm-dsp",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm-pcm-voice.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-voice.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-voice.c	2012-09-14 19:06:53.695211879 -0400
@@ -616,7 +616,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver __refdata = {
 	.driver = {
 		.name = "msm-pcm-voice",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm7k-pcm.c
===================================================================
--- msm.orig/sound/soc/msm/msm7k-pcm.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm7k-pcm.c	2012-09-14 19:06:53.695211879 -0400
@@ -674,7 +674,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_pcm_driver = {
+static struct platform_driver msm_pcm_driver __refdata = {
 	.driver = {
 		.name = "msm-dsp-audio",
 		.owner = THIS_MODULE,
Index: msm/sound/soc/msm/msm8x60-dai.c
===================================================================
--- msm.orig/sound/soc/msm/msm8x60-dai.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm8x60-dai.c	2012-09-14 19:06:53.695211879 -0400
@@ -100,7 +100,7 @@
 	return 0;
 }
 
-static struct platform_driver asoc_msm_codec_driver = {
+static struct platform_driver asoc_msm_codec_driver __refdata = {
 	.probe = asoc_msm_codec_probe,
 	.remove = __devexit_p(asoc_msm_codec_remove),
 	.driver = {
@@ -109,7 +109,7 @@
 	},
 };
 
-static struct platform_driver asoc_msm_cpu_driver = {
+static struct platform_driver asoc_msm_cpu_driver __refdata = {
 	.probe = asoc_msm_cpu_probe,
 	.remove = __devexit_p(asoc_msm_cpu_remove),
 	.driver = {
Index: msm/sound/soc/msm/mvs-dai.c
===================================================================
--- msm.orig/sound/soc/msm/mvs-dai.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/mvs-dai.c	2012-09-14 19:06:53.695211879 -0400
@@ -93,7 +93,7 @@
 	return 0;
 }
 
-static struct platform_driver asoc_mvs_codec_driver = {
+static struct platform_driver asoc_mvs_codec_driver __refdata = {
 	.probe = asoc_mvs_codec_probe,
 	.remove = __devexit_p(asoc_mvs_codec_remove),
 	.driver = {
@@ -102,7 +102,7 @@
 	},
 };
 
-static struct platform_driver asoc_mvs_cpu_driver = {
+static struct platform_driver asoc_mvs_cpu_driver __refdata = {
 	.probe = asoc_mvs_cpu_probe,
 	.remove = __devexit_p(asoc_mvs_cpu_remove),
 	.driver = {
Index: msm/sound/soc/soc-utils.c
===================================================================
--- msm.orig/sound/soc/soc-utils.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/soc-utils.c	2012-09-14 19:06:53.695211879 -0400
@@ -119,7 +119,7 @@
 	return 0;
 }
 
-static struct platform_driver soc_dummy_driver = {
+static struct platform_driver soc_dummy_driver __refdata = {
 	.driver = {
 		.name = "snd-soc-dummy",
 		.owner = THIS_MODULE,
Index: msm/net/netfilter/nf_conntrack_netlink.c
===================================================================
--- msm.orig/net/netfilter/nf_conntrack_netlink.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/netfilter/nf_conntrack_netlink.c	2012-09-14 19:06:53.695211879 -0400
@@ -2375,7 +2375,7 @@
 		ctnetlink_net_exit(net);
 }
 
-static struct pernet_operations ctnetlink_net_ops = {
+static struct pernet_operations ctnetlink_net_ops __refdata = {
 	.init		= ctnetlink_net_init,
 	.exit_batch	= ctnetlink_net_exit_batch,
 };
Index: msm/net/sunrpc/auth_gss/auth_gss.c
===================================================================
--- msm.orig/net/sunrpc/auth_gss/auth_gss.c	2012-09-14 19:06:23.000000000 -0400
+++ msm/net/sunrpc/auth_gss/auth_gss.c	2012-09-14 19:06:53.695211879 -0400
@@ -1672,7 +1672,7 @@
 	gss_svc_shutdown_net(net);
 }
 
-static struct pernet_operations rpcsec_gss_net_ops = {
+static struct pernet_operations rpcsec_gss_net_ops __refdata = {
 	.init = rpcsec_gss_init_net,
 	.exit = rpcsec_gss_exit_net,
 };
Index: msm/sound/soc/msm/msm-pcm-hostless.c
===================================================================
--- msm.orig/sound/soc/msm/msm-pcm-hostless.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/sound/soc/msm/msm-pcm-hostless.c	2012-09-14 19:06:53.695211879 -0400
@@ -45,7 +45,7 @@
 	{}
 };
 
-static struct platform_driver msm_pcm_hostless_driver = {
+static struct platform_driver msm_pcm_hostless_driver __devinitdata = {
 	.driver = {
 		.name = "msm-pcm-hostless",
 		.owner = THIS_MODULE,
Index: msm/arch/arm/mach-msm/cpufreq.c
===================================================================
--- msm.orig/arch/arm/mach-msm/cpufreq.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/cpufreq.c	2012-09-14 19:06:53.695211879 -0400
@@ -387,7 +387,7 @@
 	NULL,
 };
 
-static struct cpufreq_driver msm_cpufreq_driver = {
+static struct cpufreq_driver msm_cpufreq_driver __initdata = {
 	/* lps calculations are handled here. */
 	.flags		= CPUFREQ_STICKY | CPUFREQ_CONST_LOOPS,
 	.init		= msm_cpufreq_init,
Index: msm/arch/arm/mach-msm/footswitch-8x60.c
===================================================================
--- msm.orig/arch/arm/mach-msm/footswitch-8x60.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/footswitch-8x60.c	2012-09-14 19:06:53.695211879 -0400
@@ -550,7 +550,7 @@
 	return 0;
 }
 
-static struct platform_driver footswitch_driver = {
+static struct platform_driver footswitch_driver __refdata = {
 	.probe		= footswitch_probe,
 	.remove		= __devexit_p(footswitch_remove),
 	.driver		= {
Index: msm/arch/arm/mach-msm/footswitch-pcom.c
===================================================================
--- msm.orig/arch/arm/mach-msm/footswitch-pcom.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/footswitch-pcom.c	2012-09-14 19:06:53.695211879 -0400
@@ -299,7 +299,7 @@
 	return 0;
 }
 
-static struct platform_driver footswitch_driver = {
+static struct platform_driver footswitch_driver __refdata = {
 	.probe		= footswitch_probe,
 	.remove		= __devexit_p(footswitch_remove),
 	.driver		= {
Index: msm/arch/arm/mach-msm/msm_dsps.c
===================================================================
--- msm.orig/arch/arm/mach-msm/msm_dsps.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/msm_dsps.c	2012-09-14 19:06:53.695211879 -0400
@@ -972,7 +972,7 @@
 	return 0;
 }
 
-static struct platform_driver dsps_driver = {
+static struct platform_driver dsps_driver __refdata = {
 	.probe          = dsps_probe,
 	.remove         = __exit_p(dsps_remove),
 	.driver         = {
Index: msm/arch/arm/mach-msm/pil-modem.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-modem.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-modem.c	2012-09-14 19:06:53.695211879 -0400
@@ -286,7 +286,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_modem_driver = {
+static struct platform_driver pil_modem_driver __refdata = {
 	.probe = pil_modem_driver_probe,
 	.remove = __devexit_p(pil_modem_driver_exit),
 	.driver = {
Index: msm/arch/arm/mach-msm/pil-q6v3.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-q6v3.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-q6v3.c	2012-09-14 19:06:53.699211829 -0400
@@ -252,7 +252,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_q6v3_driver = {
+static struct platform_driver pil_q6v3_driver __refdata = {
 	.probe = pil_q6v3_driver_probe,
 	.remove = __devexit_p(pil_q6v3_driver_exit),
 	.driver = {
Index: msm/arch/arm/mach-msm/pil-tzapps.c
===================================================================
--- msm.orig/arch/arm/mach-msm/pil-tzapps.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/pil-tzapps.c	2012-09-14 19:06:53.699211829 -0400
@@ -71,7 +71,7 @@
 	return 0;
 }
 
-static struct platform_driver pil_tzapps_driver = {
+static struct platform_driver pil_tzapps_driver __refdata = {
 	.probe = pil_tzapps_driver_probe,
 	.remove = __devexit_p(pil_tzapps_driver_exit),
 	.driver = {
Index: msm/arch/arm/mach-msm/rpm-regulator.c
===================================================================
--- msm.orig/arch/arm/mach-msm/rpm-regulator.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/rpm-regulator.c	2012-09-14 19:06:53.699211829 -0400
@@ -1947,7 +1947,7 @@
 	return 0;
 }
 
-static struct platform_driver rpm_vreg_driver = {
+static struct platform_driver rpm_vreg_driver __refdata = {
 	.probe = rpm_vreg_probe,
 	.remove = __devexit_p(rpm_vreg_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/rpm.c
===================================================================
--- msm.orig/arch/arm/mach-msm/rpm.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/rpm.c	2012-09-14 19:06:53.699211829 -0400
@@ -880,7 +880,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_rpm_platform_driver = {
+static struct platform_driver msm_rpm_platform_driver __refdata = {
 	.probe = msm_rpm_probe,
 	.remove = __devexit_p(msm_rpm_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/rpm_log.c
===================================================================
--- msm.orig/arch/arm/mach-msm/rpm_log.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/rpm_log.c	2012-09-14 19:06:53.699211829 -0400
@@ -333,7 +333,7 @@
 	return 0;
 }
 
-static struct platform_driver msm_rpm_log_driver = {
+static struct platform_driver msm_rpm_log_driver __refdata = {
 	.probe		= msm_rpm_log_probe,
 	.remove		= __devexit_p(msm_rpm_log_remove),
 	.driver		= {
Index: msm/arch/arm/mach-msm/rpm_stats.c
===================================================================
--- msm.orig/arch/arm/mach-msm/rpm_stats.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/rpm_stats.c	2012-09-14 19:06:53.699211829 -0400
@@ -222,7 +222,7 @@
 	platform_set_drvdata(pdev, NULL);
 	return 0;
 }
-static struct platform_driver msm_rpmstats_driver = {
+static struct platform_driver msm_rpmstats_driver __refdata = {
 	.probe	= msm_rpmstats_probe,
 	.remove = __devexit_p(msm_rpmstats_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/saw-regulator.c
===================================================================
--- msm.orig/arch/arm/mach-msm/saw-regulator.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/saw-regulator.c	2012-09-14 19:06:53.699211829 -0400
@@ -209,7 +209,7 @@
 	return 0;
 }
 
-static struct platform_driver saw_driver = {
+static struct platform_driver saw_driver __refdata = {
 	.probe = saw_probe,
 	.remove = __devexit_p(saw_remove),
 	.driver = {
Index: msm/arch/arm/mach-msm/smd.c
===================================================================
--- msm.orig/arch/arm/mach-msm/smd.c	2012-09-14 19:06:22.000000000 -0400
+++ msm/arch/arm/mach-msm/smd.c	2012-09-14 19:06:53.699211829 -0400
@@ -3553,7 +3553,7 @@
 }
 late_initcall(modem_restart_late_init);
 
-static struct platform_driver msm_smd_driver = {
+static struct platform_driver msm_smd_driver __initdata = {
 	.probe = msm_smd_probe,
 	.driver = {
 		.name = MODULE_NAME,
